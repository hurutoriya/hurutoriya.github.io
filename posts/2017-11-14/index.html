<!doctype html><html><head><script data-ad-client=ca-pub-8604812913439531 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Shunya Ueta (a.k.a hurutoriya) personal website"><link rel="shortcut icon" href=https://shunyaueta.com/favicon.ico><link rel=stylesheet href=/css/style.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-39994406-11"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-39994406-11');</script><title>OpenCV 3.3から使えるDNNモジュールを使って物体検出</title></head><body><header id=banner><h2><a href=https://shunyaueta.com/>Software Engineer as Data Scientist</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>OpenCV 3.3から使えるDNNモジュールを使って物体検出</h1><time>2017-11-14</time></header><p>OpenCV と MobileNet を使って物体検出を行った</p><p><img src=/posts/2017-11-14/images/1.png alt=image></p><p>Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook</p><h3 id=introduction>Introduction</h3><p>物体検出を Deep Leaning と OpenCV を用いて行う</p><p>OpenCV 3.3 から<code>dnn</code>モジュールが正式にリリースされた</p><blockquote><p><em>The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (</em><a href=http://halide-lang.org><em>http://halide-lang.org</em></a>_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV.<br>_<a href=https://opencv.org/opencv-3-3.html><em>https://opencv.org/opencv-3-3.html</em></a></p></blockquote><p>今回はその dnn モジュールを使って物体検出を行う</p><ul><li><a href=https://github.com/opencv/opencv/tree/master/modules/dnn>OpenCV dnn modules</a></li><li><a href=https://github.com/opencv/opencv/tree/master/samples/dnn>Official Sample</a></li></ul><p>この記事は主に<a href=https://www.pyimagesearch.com/2017/09/11/object-detection-with-deep-learning-and-opencv/>pyimagesearch の記事</a>を参考に行いました。詳細な解説がありがたいです Deep Leaning を基にした物体検出で有名な手法は以下の 3 つである</p><ul><li>Faster R-CNN : 2015</li><li>YOLO : 2015</li><li>SSDs : 2015</li></ul><p>物体検出を行う際の DNN のアーキテクチャでは主に VGG か ResNet が用いられる。しかし欠点としてこれらのアーキテクチャは非常に大きく 200–500MB のサイズになってしまう</p><p>物体検出において速度、精度、メモリの３つのバランスを考慮する場合、どのアーキテクチャを選ぶべきかを Google が論文としてまとめている</p><p><a href=https://arxiv.org/abs/1611.10012>[1611.10012] Speed/accuracy trade-offs for modern convolutional object detectors</a></p><p>一行でまとめると、基本的に速度と精度はトレードオフであり、最速は SSDs MobileNet, 最高精度は Faster R-CNN w/Inception Resnet at stride 8</p><p>今回は省メモリかつ速度が早い SSDs MobileNet を用いて物体検出を行った</p><p>Demo on JupyterNotebook</p><h3 id=code>Code</h3><p><a href=https://github.com/hurutoriya/yolov2_api>hurutoriya/yolov2_api</a></p><h3 id=study>Study</h3><ul><li>Print デバッグをやめて、logging module に切り替えた。出力が綺麗になっていい感じ</li><li>OpenCV だけで DNN を使えるのは結構便利(学習済モデルとかは必須)</li></ul><h3 id=future-work>Future Work</h3><ul><li>YOLO v2 も C++のサンプルがあるので、Python でも動くようにしたい</li><li>Web App に組み込めるくらい速そうなので、やってみましょう</li></ul></article></main><h3>See Also</h3><ul><li><a href=/posts/2017-11-13/>Djangoで顔認識の結果をJSONで返す最小構成のAPIサーバーを作った</a></li></ul><footer id=footer>Copyright © 2013-2021 Shunya Ueta</footer></body></html>