<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>OpenCV 3.3から使えるDNNモジュールを使って物体検出 | Shunya Ueta</title><link rel=stylesheet href=/sass/main.min.1a3290acca8b3fc92df85ea9200859476d6c80d59009c89a749300f3ce7a7a67.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-39994406-11','auto');ga('send','pageview');}</script><meta property="og:title" content="OpenCV 3.3から使えるDNNモジュールを使って物体検出"><meta property="og:description" content="OpenCV と MobileNet を使って物体検出を行った
Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook
Introduction 物体検出を Deep Leaning と OpenCV を用いて行う
OpenCV 3.3 からdnnモジュールが正式にリリースされた
 The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (http://halide-lang.org_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV."><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2017-11-14/"><meta property="og:image" content="https://shunyaueta.com/ogp.jpg"><meta property="article:published_time" content="2017-11-14T11:36:43+00:00"><meta property="article:modified_time" content="2021-11-29T10:57:41+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/ogp.jpg"><meta name=twitter:title content="OpenCV 3.3から使えるDNNモジュールを使って物体検出"><meta name=twitter:description content="OpenCV と MobileNet を使って物体検出を行った
Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook
Introduction 物体検出を Deep Leaning と OpenCV を用いて行う
OpenCV 3.3 からdnnモジュールが正式にリリースされた
 The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (http://halide-lang.org_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV."></head><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/><span class=emoji>🦅</span>
Shunya Ueta</a></div><div class=flex><a href=/articles/>All posts</a>
<button id=dark-mode-button></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>OpenCV 3.3から使えるDNNモジュールを使って物体検出</h1><div class=post-meta><div>By on <time>2017.11.14</time> (Last updated:<time>2021.11.29</time>)</div><div class=tags><a href=/tags/machinelearning/>machinelearning</a>
<a href=/tags/python/>python</a>
<a href=/tags/computervision/>computervision</a>
<a href=/tags/opencv/>opencv</a></div></div></div></div></header></article><div class=article-post><p>OpenCV と MobileNet を使って物体検出を行った</p><p><img src=/posts/2017-11-14/images/1.png alt=image></p><p>Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook</p><h3 id=introduction>Introduction</h3><p>物体検出を Deep Leaning と OpenCV を用いて行う</p><p>OpenCV 3.3 から<code>dnn</code>モジュールが正式にリリースされた</p><blockquote><p><em>The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (</em><a href=http://halide-lang.org><em>http://halide-lang.org</em></a>_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV.<br>_<a href=https://opencv.org/opencv-3-3.html><em>https://opencv.org/opencv-3-3.html</em></a></p></blockquote><p>今回はその dnn モジュールを使って物体検出を行う</p><ul><li><a href=https://github.com/opencv/opencv/tree/master/modules/dnn>OpenCV dnn modules</a></li><li><a href=https://github.com/opencv/opencv/tree/master/samples/dnn>Official Sample</a></li></ul><p>この記事は主に<a href=https://www.pyimagesearch.com/2017/09/11/object-detection-with-deep-learning-and-opencv/>pyimagesearch の記事</a>を参考に行いました。詳細な解説がありがたいです Deep Leaning を基にした物体検出で有名な手法は以下の 3 つである</p><ul><li>Faster R-CNN : 2015</li><li>YOLO : 2015</li><li>SSDs : 2015</li></ul><p>物体検出を行う際の DNN のアーキテクチャでは主に VGG か ResNet が用いられる。しかし欠点としてこれらのアーキテクチャは非常に大きく 200–500MB のサイズになってしまう</p><p>物体検出において速度、精度、メモリの３つのバランスを考慮する場合、どのアーキテクチャを選ぶべきかを Google が論文としてまとめている</p><p><a href=https://arxiv.org/abs/1611.10012>[1611.10012] Speed/accuracy trade-offs for modern convolutional object detectors</a></p><p>一行でまとめると、基本的に速度と精度はトレードオフであり、最速は SSDs MobileNet, 最高精度は Faster R-CNN w/Inception Resnet at stride 8</p><p>今回は省メモリかつ速度が早い SSDs MobileNet を用いて物体検出を行った</p><p>Demo on JupyterNotebook</p><h3 id=code>Code</h3><p><a href=https://github.com/hurutoriya/yolov2_api>hurutoriya/yolov2_api</a></p><h3 id=study>Study</h3><ul><li>Print デバッグをやめて、logging module に切り替えた。出力が綺麗になっていい感じ</li><li>OpenCV だけで DNN を使えるのは結構便利(学習済モデルとかは必須)</li></ul><h3 id=future-work>Future Work</h3><ul><li>YOLO v2 も C++のサンプルがあるので、Python でも動くようにしたい</li><li>Web App に組み込めるくらい速そうなので、やってみましょう</li></ul></div><h2>See Also</h2><ul><li><a href=/posts/2017-11-13/>Djangoで顔認識の結果をJSONで返す最小構成のAPIサーバーを作った</a></li></ul></div><div class=container><nav class="flex container suggested"><a rel=prev href=/posts/2017-11-13/ title="Previous post (older)"><span>Previous</span>
Djangoで顔認識の結果をJSONで返す最小構成のAPIサーバーを作った</a>
<a rel=next href=/posts/2017-11-22/ title="Next post (newer)"><span>Next</span>
Jupyter上でSVGのイラストやアニメーションが作成できるプラグイン egel</a></nav></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links><a href=/index.xml>RSS</a></nav></section><script async src=/js/features.min.a94f58a30ad2560de728e080d87f75c60cf806fd1b3d5f4815f1a1a02c0d1859.js></script></footer></body></html>