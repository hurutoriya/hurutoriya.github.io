<!doctype html><html lang=ja><head><meta http-equiv=x-clacks-overhead content="GNU Terry Pratchett"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる | hurutoriya</title><meta name=title content="Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる"><meta name=description content="データ分析などをしていると、画像はダウンロードせずに特定の CDN (GCP なら GCS, AWS なら S3 など)で提供されている画像を参照して、 Jupyter Notebook 上で良い感じに表示させたいときがありませんか?
例えば、画像と説明文がペアになっているデータを画像自体はダウンロードせずに Jupyter 上で画像と説明文を DataFrame として表示させたいときが多々ある。 元の画像自体は CDN に格納されていて、画像をダウンロードする必要はなく参照するだけのときにはすごく便利。 毎度画像を CDN からダウンロードするのも無駄なので、画像を加工せずに Jupyter 上で表示するだけなら、この方法がベストですね。
url からとってきた画像を jupyter に表示する でも同じような課題に取り組んでいるが、今回紹介する方法なら余計なパッケージを入れずに最小構成で Jupyter 上で表示できるのが利点。
import pandas as pd from IPython.display import HTML # NOTE: https://www.irasutoya.com/2021/01/onepiece.html から画像を参照 onepiece = { &#34;モンキー・D・ルフィ&#34; : &#34;https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png&#34;, &#34;ロロノア・ゾロ&#34; : &#34;https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png&#34;, &#34;ナミ&#34; : &#34;https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png&#34;, &#34;そげキング（ウソップ）&#34; : &#34;https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png&#34;, } df = pd.DataFrame({&#34;Name&#34;: onepiece.keys(), &#34;Image&#34;: onepiece.values()}) def path_to_image_html(path): return f'<img src=&#34;{path}&#34;/>' pd."><meta name=keywords content="python,pandas,jupyter,"><meta property="og:title" content="Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる"><meta property="og:description" content="データ分析などをしていると、画像はダウンロードせずに特定の CDN (GCP なら GCS, AWS なら S3 など)で提供されている画像を参照して、 Jupyter Notebook 上で良い感じに表示させたいときがありませんか?
例えば、画像と説明文がペアになっているデータを画像自体はダウンロードせずに Jupyter 上で画像と説明文を DataFrame として表示させたいときが多々ある。 元の画像自体は CDN に格納されていて、画像をダウンロードする必要はなく参照するだけのときにはすごく便利。 毎度画像を CDN からダウンロードするのも無駄なので、画像を加工せずに Jupyter 上で表示するだけなら、この方法がベストですね。
url からとってきた画像を jupyter に表示する でも同じような課題に取り組んでいるが、今回紹介する方法なら余計なパッケージを入れずに最小構成で Jupyter 上で表示できるのが利点。
import pandas as pd from IPython.display import HTML # NOTE: https://www.irasutoya.com/2021/01/onepiece.html から画像を参照 onepiece = { &#34;モンキー・D・ルフィ&#34; : &#34;https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png&#34;, &#34;ロロノア・ゾロ&#34; : &#34;https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png&#34;, &#34;ナミ&#34; : &#34;https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png&#34;, &#34;そげキング（ウソップ）&#34; : &#34;https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png&#34;, } df = pd.DataFrame({&#34;Name&#34;: onepiece.keys(), &#34;Image&#34;: onepiece.values()}) def path_to_image_html(path): return f'<img src=&#34;{path}&#34;/>' pd."><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2021-12-28/"><meta property="og:image" content="https://shunyaueta.com/ogp.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-28T23:04:19+09:00"><meta property="article:modified_time" content="2021-12-28T23:04:19+09:00"><meta property="og:site_name" content="Shunya Ueta"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/ogp.jpg"><meta name=twitter:title content="Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる"><meta name=twitter:description content="データ分析などをしていると、画像はダウンロードせずに特定の CDN (GCP なら GCS, AWS なら S3 など)で提供されている画像を参照して、 Jupyter Notebook 上で良い感じに表示させたいときがありませんか?
例えば、画像と説明文がペアになっているデータを画像自体はダウンロードせずに Jupyter 上で画像と説明文を DataFrame として表示させたいときが多々ある。 元の画像自体は CDN に格納されていて、画像をダウンロードする必要はなく参照するだけのときにはすごく便利。 毎度画像を CDN からダウンロードするのも無駄なので、画像を加工せずに Jupyter 上で表示するだけなら、この方法がベストですね。
url からとってきた画像を jupyter に表示する でも同じような課題に取り組んでいるが、今回紹介する方法なら余計なパッケージを入れずに最小構成で Jupyter 上で表示できるのが利点。
import pandas as pd from IPython.display import HTML # NOTE: https://www.irasutoya.com/2021/01/onepiece.html から画像を参照 onepiece = { &#34;モンキー・D・ルフィ&#34; : &#34;https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png&#34;, &#34;ロロノア・ゾロ&#34; : &#34;https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png&#34;, &#34;ナミ&#34; : &#34;https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png&#34;, &#34;そげキング（ウソップ）&#34; : &#34;https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png&#34;, } df = pd.DataFrame({&#34;Name&#34;: onepiece.keys(), &#34;Image&#34;: onepiece.values()}) def path_to_image_html(path): return f'<img src=&#34;{path}&#34;/>' pd."><meta itemprop=name content="Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる"><meta itemprop=description content="データ分析などをしていると、画像はダウンロードせずに特定の CDN (GCP なら GCS, AWS なら S3 など)で提供されている画像を参照して、 Jupyter Notebook 上で良い感じに表示させたいときがありませんか?
例えば、画像と説明文がペアになっているデータを画像自体はダウンロードせずに Jupyter 上で画像と説明文を DataFrame として表示させたいときが多々ある。 元の画像自体は CDN に格納されていて、画像をダウンロードする必要はなく参照するだけのときにはすごく便利。 毎度画像を CDN からダウンロードするのも無駄なので、画像を加工せずに Jupyter 上で表示するだけなら、この方法がベストですね。
url からとってきた画像を jupyter に表示する でも同じような課題に取り組んでいるが、今回紹介する方法なら余計なパッケージを入れずに最小構成で Jupyter 上で表示できるのが利点。
import pandas as pd from IPython.display import HTML # NOTE: https://www.irasutoya.com/2021/01/onepiece.html から画像を参照 onepiece = { &#34;モンキー・D・ルフィ&#34; : &#34;https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png&#34;, &#34;ロロノア・ゾロ&#34; : &#34;https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png&#34;, &#34;ナミ&#34; : &#34;https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png&#34;, &#34;そげキング（ウソップ）&#34; : &#34;https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png&#34;, } df = pd.DataFrame({&#34;Name&#34;: onepiece.keys(), &#34;Image&#34;: onepiece.values()}) def path_to_image_html(path): return f'<img src=&#34;{path}&#34;/>' pd."><meta itemprop=datePublished content="2021-12-28T23:04:19+09:00"><meta itemprop=dateModified content="2021-12-28T23:04:19+09:00"><meta itemprop=wordCount content="120"><meta itemprop=image content="https://shunyaueta.com/ogp.jpg"><meta itemprop=keywords content="python,pandas,jupyter,"><meta name=referrer content="no-referrer-when-downgrade"><style>body{font-family:Verdana,sans-serif;margin:auto;padding:20px;max-width:720px;text-align:left;background-color:#fff;word-wrap:break-word;overflow-wrap:break-word;line-height:1.5;color:#444}h1,h2,h3,h4,h5,h6,strong,b{color:#222}a{color:#3273dc}.title{text-decoration:none;border:0}.title span{font-weight:400}nav a{margin-right:10px}textarea{width:100%;font-size:16px}input{font-size:16px}content{line-height:1.6}table{width:100%}img{max-width:100%}code{padding:2px 5px;background-color:#f2f2f2}pre code{color:#222;display:block;padding:20px;white-space:pre-wrap;font-size:14px;overflow-x:auto}div.highlight pre{background-color:initial;color:initial}div.highlight code{background-color:unset;color:unset}blockquote{border-left:1px solid #999;color:#222;padding-left:20px;font-style:italic}footer{padding:25px;text-align:center}.helptext{color:#777;font-size:small}.errorlist{color:#eba613;font-size:small}ul.blog-posts{list-style-type:none;padding:unset}ul.blog-posts li{display:flex}ul.blog-posts li span{flex:0 0 130px}ul.blog-posts li a:visited{color:#8b6fcb}@media(prefers-color-scheme:dark){body{background-color:#333;color:#ddd}h1,h2,h3,h4,h5,h6,strong,b{color:#eee}a{color:#8cc2dd}code{background-color:#777}pre code{color:#ddd}blockquote{color:#ccc}textarea,input{background-color:#252525;color:#ddd}.helptext{color:#aaa}}</style><script async src="https://www.googletagmanager.com/gtag/js?id=G-JMJRQJT0Q3"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JMJRQJT0Q3")</script></head><body><header><a href=/ class=title><h2>hurutoriya</h2></a><nav><a href=/index.xml>RSS</a>
<a href=/about/>著者について</a></nav></header><main><h1>Jupyter Notebook で画像をダウンロードすることなく、URLから参照してPandas DataFrame内部に表示させる</h1><p><i><time datetime=2021-12-28 pubdate>2021-12-28</time></i></p><content><p>データ分析などをしていると、画像はダウンロードせずに特定の CDN (GCP なら GCS, AWS なら S3 など)で提供されている画像を参照して、 Jupyter Notebook 上で良い感じに表示させたいときがありませんか?</p><p>例えば、画像と説明文がペアになっているデータを画像自体はダウンロードせずに Jupyter 上で画像と説明文を DataFrame として表示させたいときが多々ある。
元の画像自体は CDN に格納されていて、画像をダウンロードする必要はなく参照するだけのときにはすごく便利。
毎度画像を CDN からダウンロードするのも無駄なので、画像を加工せずに Jupyter 上で表示するだけなら、この方法がベストですね。</p><p><a href=https://tsukin.hateblo.jp/entry/2020/04/08/162605>url からとってきた画像を jupyter に表示する</a> でも同じような課題に取り組んでいるが、今回紹介する方法なら余計なパッケージを入れずに最小構成で Jupyter 上で表示できるのが利点。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> IPython.display <span style=color:#f92672>import</span> HTML
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># NOTE: https://www.irasutoya.com/2021/01/onepiece.html から画像を参照</span>
</span></span><span style=display:flex><span>onepiece <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;モンキー・D・ルフィ&#34;</span> : <span style=color:#e6db74>&#34;https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ロロノア・ゾロ&#34;</span> : <span style=color:#e6db74>&#34;https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ナミ&#34;</span> : <span style=color:#e6db74>&#34;https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;そげキング（ウソップ）&#34;</span> : <span style=color:#e6db74>&#34;https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png&#34;</span>,
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#34;Name&#34;</span>: onepiece<span style=color:#f92672>.</span>keys(),
</span></span><span style=display:flex><span>                   <span style=color:#e6db74>&#34;Image&#34;</span>: onepiece<span style=color:#f92672>.</span>values()})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>path_to_image_html</span>(path):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;&lt;img src=&#34;</span><span style=color:#e6db74>{</span>path<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;/&gt;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#39;display.max_colwidth&#39;</span>, <span style=color:#66d9ef>None</span>)
</span></span><span style=display:flex><span>HTML(df<span style=color:#f92672>.</span>to_html(escape<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span> ,formatters<span style=color:#f92672>=</span>dict(Image<span style=color:#f92672>=</span>path_to_image_html)))
</span></span></code></pre></div><p>結果はこうなる</p><p><img src=/posts/2021-12-28/images/1.png alt="Jupyter 上でDataFrame内部に画像が表示されている"></p><p>やっていることとしては、</p><ol><li>Pandas の<a href=https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_html.html>DataFrame.to_html()</a>関数で、DataFrame を HTML に変換</li><li>変換時に、<code>escape=False</code> にすることでエスケープせずに HTML を出力</li><li><code>formatters</code>では、特定のカラムに関数を適用して変換できる。この関数は文字列を返す関数でなくてはならない。</li><li>最後に出力された HTML を <code>IPython.display</code> の<code>HTML</code>モジュールで HTML を Jupyter 上で表示</li></ol><h2 id=appendix>Appendix</h2><p>Gist はこちら</p><p>Colab でも公開しておきます</p><p><a href="https://colab.research.google.com/drive/1ufdIjcElRjmOLeYOy2RplgqXxaHXOgau?usp=sharing">Colab link</a></p><h2 id=references>References</h2><ul><li><a href=https://tsukin.hateblo.jp/entry/2020/04/08/162605>url からとってきた画像を jupyter に表示する</a></li><li><a href=https://stackoverflow.com/questions/37365824/pandas-ipython-notebook-include-and-display-an-image-in-a-dataframe>Pandas / IPython Notebook: Include and display an Image in a dataframe</a></li></ul><h2>関連しているかもしれない記事</h2><ul><li><a href=/posts/2020-09-09/>pandas を使って特定のディレクトリのCSVファイルをすべて連結して一つのCSVファイルを作成</a></li><li><a href=/posts/2019-10-03/>遅すぎる `pandas.read_gbq` を使わずに、Google BigQueryから高速にデータを読み込む</a></li><li><a href=/posts/2019-09-25/>Jupyter Notebook上にTensorboard を わずか2行で表示させる</a></li><li><a href=/posts/2018-04-23/>Google Colaboratory で Mecab-ipadic-Neologd を使用可能にする</a></li><li><a href=/posts/2018-01-15/>Jupyter Notebookの差分を明瞭に確認する事ができるpackage : nbdime</a></li></ul><h2>Support</h2>記事をお読みくださりありがとうございます。
このウェブサイトの運営を支援していただける方を募集しています。
もしよろしければ、<a href=https://www.buymeacoffee.com/hurutoriya>Buy Me a Coffee</a> からサポート(投げ銭)していただけると、記事の執筆、情報発信のモチベーションに繋がります✨<p>--</p>記事を楽しめましたか？
<a href=/index.xml>RSS</a>で更新情報を配信しているので、お好きなフィードリーダーで購読してみてください。</br>記事への感想などの<a href=https://forms.gle/g4rNMwPL799uHXQg7>おたより</a>をおまちしてます。
(おたより機能はGoogle フォームで実現しており、hurutoriya 個人が管理するGoogleフォームに記録されます。)
お気軽にお送りください。
お返事はメールアドレス入力があればメールでさせていただきます。
もちろんお返事を希望せずに単なる感想だけでも大歓迎です。</content><p><a href=https://shunyaueta.com/tags/python/>#python</a>
<a href=https://shunyaueta.com/tags/pandas/>#pandas</a>
<a href=https://shunyaueta.com/tags/jupyter/>#jupyter</a></p><script src=https://giscus.app/client.js data-repo=hurutoriya/hurutoriya.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk2MDgyNTY1Nw==" data-category=Comments data-category-id=DIC_kwDOA6AgOc4CAQTX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=dark data-lang=ja crossorigin=anonymous async></script></main><footer>Made with <a href=https://github.com/janraasch/hugo-bearblog/>Hugo ʕ•ᴥ•ʔ Bear</a></footer></body></html>