<!doctype html><html><head><script data-ad-client=ca-pub-8604812913439531 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>pipenv でローカルパッケージが正常にインストールされないときの対処法 - hurutoriya</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:image" content><meta property="og:title" content="pipenv でローカルパッケージが正常にインストールされないときの対処法"><meta property="og:description" content="TL; DR; pip install pipenv==2018.11.26 をすれば直った!!!!! 実行環境 $pipenv --version pipenv, version 2020.11.15 直面した問題 ./app/ ├── model │ └── setup.py └── serving └── Pipfile のような構成で、modelというローカルパッケージを作成しており、serving 直下のPipfile は、model を読み込んでsetup.p"><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2021-03-13/"><meta property="article:published_time" content="2021-03-13T21:43:44+09:00"><meta property="article:modified_time" content="2021-03-13T21:43:44+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="pipenv でローカルパッケージが正常にインストールされないときの対処法"><meta name=twitter:description content="TL; DR; pip install pipenv==2018.11.26 をすれば直った!!!!! 実行環境 $pipenv --version pipenv, version 2020.11.15 直面した問題 ./app/ ├── model │ └── setup.py └── serving └── Pipfile のような構成で、modelというローカルパッケージを作成しており、serving 直下のPipfile は、model を読み込んでsetup.p"><script src=https://shunyaueta.com/js/feather.min.js></script><link href=https://shunyaueta.com/css/fonts.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://shunyaueta.com/css/main.css><link rel=stylesheet type=text/css href=https://shunyaueta.com/css/dark.css media="(prefers-color-scheme: dark)"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-39994406-11"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-39994406-11');</script></head><body><div class=content><header><div class=main><a href=https://shunyaueta.com/>hurutoriya</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>pipenv でローカルパッケージが正常にインストールされないときの対処法</h1><div class=meta>Posted on Mar 13, 2021</div></div><section class=body><h2 id=tl-dr>TL; DR;</h2><ul><li>pip install pipenv==2018.11.26 をすれば直った!!!!!</li></ul><h2 id=実行環境>実行環境</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$pipenv --version
pipenv, version 2020.11.15
</code></pre></div><h2 id=直面した問題>直面した問題</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./app/
├── model
│   └── setup.py
└── serving
    └── Pipfile
</code></pre></div><p>のような構成で、<code>model</code>というローカルパッケージを作成しており、serving 直下のPipfile は、<code>model</code> を読み込んでsetup.py に記述されている依存パッケージもインストールするようにしたい。</p><p>serving ディレクトリで、以下のコマンドを入力すればローカルパッケージがpipenv によりインストールされるはずだが</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pipenv install --editable ../model
</code></pre></div><p>依存関係をすべて記述するはずのPipenv.lock には、<code>model</code>のパスのみが記述され、ローカルパッケージが要求する依存パッケージが記述されていない。</p><p>原因を探してみたところ、</p><p><a href=https://github.com/pypa/pipenv/issues/1024>Installing a local package with pipenv install &lsquo;-e .&rsquo; doesn&rsquo;t save dependencies #1024</a></p><p>同じ GitHub issue を発見しダメ元で pipenv を以下のコマンドでダウングレードして見たところ</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>pip install pipenv<span style=color:#f92672>==</span>2018.11.26
</code></pre></div><p>なんと&mldr;. 直った。無事にローカルパッケージの依存パッケージが Pipenv.lock に記述されており、無事にローカルパッケージがserving 直下で動くようになった。</p><p>後方互換性が無いとかそんなちゃちな問題ではない気がするのだが、この問題でかなり時間が溶けたので非常に精神的に消耗した。</p><p>思えばこういう問題が多くて、普段はpoetry を使っていたのを思い出した。</p><h2 id=ref>Ref</h2><ul><li><a href=https://stackoverflow.com/questions/53505681/installing-dependencies-of-a-local-dependency-with-pipenv>Installing dependencies of a local dependency with pipenv</a></li></ul></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/python>Python</a></li></ul></nav></div></article></main><h3>See Also</h3><ul><li><a href=/posts/2021-02-08/>pip 実行時に sys.stderr.write(f"ERROR: {exc} ") とエラーが出てpipを実行できないときの対処方法</a></li><li><a href=/posts/2020-12-26/>Apache beam 入門</a></li><li><a href=/posts/2020-09-09/>pandas を使って特定のディレクトリのCSVファイルをすべて連結して一つのCSVファイルを作成</a></li><li><a href=/posts/2020-08-23/>Python の内包表記とジェネレータ式のメモリ使用量比較</a></li><li><a href=/posts/2020-07-25/>How to write the UnitTest with stdin at Pytest</a></li></ul><footer><hr><a class=soc href=https://github.com/hurutoriya title=GitHub><i data-feather=github></i></a>|<a class=soc href=https://twitter.com/hurutoriya/ title=Twitter><i data-feather=twitter></i></a>|⚡️
2021 © Shunya Ueta | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></footer><script>feather.replace()</script></div></body></html>