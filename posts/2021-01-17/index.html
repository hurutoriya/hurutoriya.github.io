<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」 | 🦅 hurutoriya</title><meta name=keywords content="tensorflow,machinelearning,mlops,mlengineering,paper,translation"><meta name=description content="この記事はMLOps Advent Calendar 2020の 25 日目の記事です。(盛大に遅れました)
KDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、TensorFlow の Blogで該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。
 注意)この翻訳記事は原著論文の著者陣からレビューはされていません Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.  Citation  Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … & Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***
 Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019 Towards ML Engineering with TensorFlow Extended (TFX) ACM PDF は arxiv でも閲覧可能  https://arxiv."><meta name=author content="Shunya Ueta"><link rel=canonical href=https://shunyaueta.com/posts/2021-01-17/><link crossorigin=anonymous href=/assets/css/stylesheet.min.f00f189851525f5dc525fa12dfc10fa3656c6cc16f26285e5f7347522031587e.css integrity="sha256-8A8YmFFSX13FJfoS38EPo2VsbMFvJiheX3NHUiAxWH4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://shunyaueta.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shunyaueta.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shunyaueta.com/favicon-32x32.png><link rel=apple-touch-icon href=https://shunyaueta.com/apple-touch-icon.png><link rel=mask-icon href=https://shunyaueta.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-39994406-11','auto');ga('send','pageview');}</script><meta property="og:title" content="TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」"><meta property="og:description" content="この記事はMLOps Advent Calendar 2020の 25 日目の記事です。(盛大に遅れました)
KDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、TensorFlow の Blogで該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。
 注意)この翻訳記事は原著論文の著者陣からレビューはされていません Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.  Citation  Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … & Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***
 Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019 Towards ML Engineering with TensorFlow Extended (TFX) ACM PDF は arxiv でも閲覧可能  https://arxiv."><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2021-01-17/"><meta property="og:image" content="https://shunyaueta.com/ogp.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-17T00:18:47+09:00"><meta property="article:modified_time" content="2022-04-08T23:06:50+09:00"><meta property="og:site_name" content="Shunya Ueta"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/ogp.jpg"><meta name=twitter:title content="TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」"><meta name=twitter:description content="この記事はMLOps Advent Calendar 2020の 25 日目の記事です。(盛大に遅れました)
KDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、TensorFlow の Blogで該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。
 注意)この翻訳記事は原著論文の著者陣からレビューはされていません Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.  Citation  Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … & Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***
 Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019 Towards ML Engineering with TensorFlow Extended (TFX) ACM PDF は arxiv でも閲覧可能  https://arxiv."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」","item":"https://shunyaueta.com/posts/2021-01-17/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」","name":"TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」","description":"この記事はMLOps Advent Calendar 2020の 25 日目の記事です。(盛大に遅れました)\nKDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、TensorFlow の Blogで該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。\n 注意)この翻訳記事は原著論文の著者陣からレビューはされていません Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.  Citation  Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … \u0026amp; Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***\n Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019 Towards ML Engineering with TensorFlow Extended (TFX) ACM PDF は arxiv でも閲覧可能  https://arxiv.","keywords":["tensorflow","machinelearning","mlops","mlengineering","paper","translation"],"articleBody":"この記事はMLOps Advent Calendar 2020の 25 日目の記事です。(盛大に遅れました)\nKDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、TensorFlow の Blogで該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。\n 注意)この翻訳記事は原著論文の著者陣からレビューはされていません Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.  Citation  Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … \u0026 Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***\n Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019 Towards ML Engineering with TensorFlow Extended (TFX) ACM PDF は arxiv でも閲覧可能  https://arxiv.org/abs/2010.02013    TFX を知らない方向け TFXとは、Google が開発する TensorFlow Extended(TFX)の略称で、Google 社内で開発された TensorFlow を基にした機械学習基盤のプロジェクト。 TFX の各コンポーネントは OSS として公開されている。\n抄訳 Abstract ソフトウェアエンジニアリングは成熟しつつあるが、一方で機械学習エンジニアリングはまだ成熟しきっていない。この論文では Alphabet で成功しているエンドツーエンドの機械学習基盤である Sybil, TFX の紹介を行う。主に TFX が機械学習エンジニアリングの実現にどう役立つかについて紹介していく。そして我々は機械学習による恩恵を受けるために、まずは機械学習チームの成熟と強固なインフラストラクチャ、組織内での教育活動が同時に必要であることを主張する。また、先進的なモデル開発を行う前に、容易に相互運用可能な機械学習基盤導入を強くすすめる。\nWhere We Are Coming From Sibyl 2002-2020 2007 年からSibyl は運用開始されており、2020 年まで運用されていた。最近では開発は廃止され、TFX に移行中であり、主に非深層学習をサポートする機械学習基盤である。\nTFX と同等のミドルウェアである Data Ingestion, Data Analysis and Validation, Training (of course), Model Analysis, and Training-Serving Skew Detection を解決するコンポーネントが存在している。\n(といっても Sibyl は TFX の先祖みたいなものなので、TFX がこれらの機能を踏襲してると考えるのが正しそうですね)\nTFX (2017 - ?) 2015 年からは深層学習の台頭により、TensorFlow がリリースされた。TensorFlow の課題点としてエンドツーエンドの機械学習基盤としては提供されてはいないことである。Sibyl は逆に深層学習用途に対する柔軟性が足りていないのが欠点であり、それらを補うために TFX の開発を開始したのは 2017 年のことだった。偶然にも TFX は Sibyl 誕生から約十年後に開発されことになった。\nTFX の運用開始から 3 年、Alphabet 内で TFX は企業レベルの機械学習基盤として数千のユーザーから使われており、数百の Alphabet (GCP 含む) の機械学習プロダクトを支えている。毎日数千の TFX のパイプラインが稼働し、エクサスケールのデータとともに数万ものモデルが生み出されており、TFX が提供する推論のリクエスト数は秒間数百万超えの規模になっている。TFX により Alphabet 内の研究成果がより早くプロダクションにリリースされ、機械学習基盤の開発よりもモデル開発に集中することが可能になった。\nTensorFlow が Alphabet 内部、そして外部でも人気と衝撃を与えたのと同じく、機械学習エンジニアから TFX にも人気と衝撃が走った。外部の機械学習エンジニアからの要望を叶えるために我々は TFX を徐々に OSS で公開していった。TFX, sibyl は Google 内部の強固なインフラストラクチャから構成されており、そのおかげで OSS での公開が加速した。例えば Sibyl は MapReduce と Flume を使ったデータ処理を行っており、TFX は同じくポータビリティ性の高い Apache beam をベースにしているので OSS での公開がスムーズに進んだ。\nTFX は最終的に 2019 年の頭に OSS として公開され、オンプレスミスや GCP の Cloud AI Platform Pipelines などで活用可能になった。パートナー企業も TFX を活用し始めており、実践的な機械学習の開発速度が改善されはじめている。\n参考文献: The Winding Road to Better Machine Learning Infrastructure Through Tensorflow Extended and Kubeflow\nLessons From Our 10+ Year Journey Of ML Platform Evolution Google での機械学習基盤の進化の旅は長くそしてワクワクするものであり、ぜひとも我々が学んだことをここで共有したい。\n我々が学んだことは大きく 2 つに分類される。\nこの長い旅で\n 何が変わり 何が変わらなかったのか  だ。Sibyl と TFX の開発を通じで学んだことを共有するが、Google 外部での機械学習基盤開発にも適用可能だと我々は信じている。\nWhat Remains The Same And 何が変わらず、そしてなぜそれが残ったのか この章では Sibyl, TFX の両者の長期間の運用期間にも耐えることができた機械学習とインフラストラクチャの観点についてまず説明を行う。\nApplied ML Rules of Machine Learning という Google 内部での機械学習プロダクト開発で学んだ経験則を我々は公開している。\nRules of Machine Learning の一例\n シンプルなルールベースとヒューリスティックから開発をまずはじめ、そこからデータを生み出し学びを深めよう。基本的にはここでルールベースのサービングシステムを開発する。 次に単純な機械学習モデルに移行することで、大きな利益を実現させます。ここでやっと機械学習パイプラインが導入される。 特徴量を増やし機械学習モデルも先進的なものを適用してみる。 SOTA を達成した機械学習モデルを適用してみまる(管理コストは増大しパイプラインも複雑になるが、それに見合った価値があることが前提である。) 上記のサイクルを念頭に置いて機械学習プロダクトの開発に役立ててみよう。そして常に費用対効果(ROI)は忘れないようにするのが大事である。  我々は Rules of Machine Learning がたとえサービスドメインや稼働する基盤が異なったり、時間が経過したとしても揺るぎない価値があると信じている。特に機械学習エンジニアリングの観点において Rules of Machine Learning は我々とその読者の致命的な失敗を避ける助けになると信じており、TFX は上記の流れを極めて高速に試行するのに役立つ。\nThe Discipline Of ML Engineering Rules of Machine Learning の作成を通じ、我々はソフトウェアエンジニアリングを基にした複雑なコードとデータの処理が実行可能な頑強なシステムの理念を学んだ。ここで我々は機械学習エンジニアリングを以下のように定義する。\n 機械学習エンジニアリングの定義: ソフトウェアエンジニアリングを包含する形での実践的な機械学習の複雑性を制御するための学問  実際、機械学習エンジニアリングのすべてをまとめようとするのは、なかなか難しいが\n 我々の持っている限られた理解していることは、プラットフォームと時間を超えてうまく稼働している 過去から学び、相似のものとしてみなすことは強力なアプローチであり、ソフトウェアエンジニアリングの様々な視点は、機械学習エンジニアリングにより機械学習プログラミングをどう進化させれるかが分かる  参考書籍: Software Engineering at Google: Lessons Learned from Programming over Time\nTFX に関する基礎的な考えは、TFX: A TensorFlow-Based Production-Scale Machine Learning Platform にて公開されており、現在 ML metadata を軸にして OSS として公開されている。\nでは、これから機械学習エンジニアリングの基礎的な要素について、ソフトウェアエンジニアリングとの相似を基に説明を行う。\nData ソフトウェアの中心がコードであるように、データは機械学習の中心的な存在である。データマネジメントはプロダクション環境での機械学習適用において挑戦的な課題である。\n参考文献: Data Management Challenges in Production Machine Learning\nまずはデータに対するユニットテストを考える。ユニットテストはコードがどのように振る舞うべきかを検証する。同様に、データ形式への明示的な期待(スキーマ、不変量や分布)を設定し検証を行うことができる。\n参考文献: Data Validation for Machine Learning\nコードリポジトリとバージョンコントロールは、コード管理の軸となっている。。データ管理を行うことができるシステムはまた機械学習エンジニアリングでも同様に重要である。TFX の ExampleGen, StasticsGen, SchmaGen と Example Validator の各種コンポーネントにより継続的な機械学習パイプラインのデータ管理、分析、検証が可能になりデータをコードのように扱うために非常に役に立つ。\n参考文献: TensorFlow DataValidation , The ExampleGen TFX Pipeline Component\nModels (機械学習モデル) ソフトウェアエンジニアがコンパイルされたコードを作成するのと同じように、機械学習エンジニアは、データとコードを基に「コンパイル」された機械学習プログラムを作成する。コンパイルされたものが、一般的には機械学習モデルとして知られている。この 2 種類のプログラムの性質は大きく異なっている。ソフトウェアはプログラムを通して一貫性を保つが、機械学習モデルは一貫性を保つことが非常に難しい。またこの一貫性の検証は何かしらの要約された形式でしか検証できない。(例えばラベルデータの部分集合で十分な精度が出ているなどの形でしか機械学習モデルの一貫性の保証ができない)\nコードとデータは時間経過により変化し、モデルもそれに伴い変化する。しかし、モデルの変化はコードやデータの変化に比べて更に複雑になる。例えば、コードに対する高いテストカバレッジはコードの一部の正しさと変化に対する高い信頼性を得ることができるが、モデルに対するテストでは、分布外のデータや因果関係を理解できるデータを作成しテストすることはとても困難である。\n同じく結合テストでも同じ問題が発生し、end-to-end でのモデルの検証と理解が機械学習エンジニアリングの重要な構成要素である。\n参考文献: Slice Finder: Automated Data Slicing for Model Validation\nTFX の evaluator と InfraValidator コンポーネントはモデルの検証と理解についての機能を提供する。これらもまた機械学習エンジニアリングの大事な一要素である。\nThe Evaluator TFX Pipeline Component\nMergeable Fragments ソフトウェアエンジニアがプログラムを既存のパッケージを合わせて作成するのと同じように、機械学習エンジニアはコード、データ、解析、モデルの断片を合わせて機械学習パイプラインを構築する。ソフトウェアエンジニアリングと機械学習エンジニアリングの決定的な違いは、コードは不変だが、データは常に揮発性を持ってり、変化する点である。(基本的にデータは常に新しくなり続ける)。例えば、入力データの一部分でも傾向が変化した場合には、それに対応して新しいモデルを作成する必要がある。\nこのように作成される生成物は常に mergeable (併合可能) であることは、機械学習パイプラインにおいて重要である。例えば一つのデータセットの統計値の要約は、2 つのデータセットの和集合の統計値を簡単に要約できるように、もう一つのデータセットへ簡単に併合可能であるべきである。またモデルの観点から言えば、一つのモデルの学習を別のモデルへと簡単に転移学習できるようにしておくべきである。\nしかしこれは前章で述べたモデルのテストカバレッジと同じ課題を抱えている。新しくモデルにフラグメントをマージすると、分布外データや反実仮想の評価データの作成が必要になる可能性があり、それによってモデルの複雑性があがってしまう。\nTFX の Example Gen, Transform, Trainer, Tuner のコンポーネントはTensorFlow Hub で管理され、併合可能なパイプラインを作成することに役立ちます。\nArtifact Lineage (生成物の経路追跡) ソフトウェアエンジニアリングは方法論やツールなどが高度に発展しているが、それでも常にデバッグが必要である。それは機械学習プログラムも同様の課題があるが、ソフトウェアエンジニアリングと比べると一段と難易度が増す。なぜなら、機械学習プログラムではプログラムに付随する生成物が難易度への影響を与えている。モデルのデバッグを行う際にコードの欠陥、学習アルゴリズム、学習データ、サービングパス、サービングされるデータなどいくつものエラー原因があり、それらが原因で精度の低下につながる。ソフトウェア開発において、根本原因を探すためにスタックトレースが重要なように、機械学習パイプラインではすべての生成物の生産と消費の追跡が機械学習モデルの精度劣化の根本原因の解明に役立つ。\nTFX ではML Metadata (MLMD) を使用して、生成物を管理している。MLMD は、生成物のメタデータ管理と追跡を可能にし、機械学習パイプライン外に高い信頼性を持って生成物の管理が可能になる。\nContinuous Learning And Unlerning プロダクション環境下での機械学習パイプラインは、動的な環境下で以下の特徴がある。\n 定期的に新しいデータが到来する モデルのコードは、初期段階では頻繁に変化する インフラ面も変化する  もし上記の変化が発生した場合、パイプラインはそれらに対して追従する必要があり、変更後の環境でパイプラインを新たに実行する必要がある。パイプライン実行の監視は、デバッグと原因究明の解析にとても有用である。例えば単純な例では、モデルの失敗原因をデバッグするためには、どのデータが学習済のモデルに使われたかだけではなく、モデルコードとパッケージのバージョンの把握が必要不可欠である。\n機械学習パイプラインはそれらの変化に対して対応できる仕組みが必要である。例えば新しいデータが到来した際には、モデルの再学習が必須である。これらは推薦システムや広告関係などのように迅速に変化する環境においてごく自然に要求される。もしデータが頻繁かつ定期的に変化する環境だった場合、エンジニアが手作業でモデルの再学習を実行することが要求されているならそれは非現実的である。その代わりに TFX はパイプラインが新規のデータを検知して、モデルの再学習を行うことで継続的学習を実現し、手作業を自動化することができる。その自動化を実現するためには高度なオーケストレーションが必要である。また機械学習パイプラインは、何年間もコードとデータを取り込み、継続的に意思決定に役立つ予測を行うモデルを作成するのが一般的である。\n参考文献: Continuous Training for Production ML in the TensorFlow Extended (TFX) Platform\n次に機械学習パイプラインのために必要とされる仕組みの例では、backfilling 機能がある。例えば、モデルのパッケージやコードは更新済のものを既存のデータに適用するケースなど、エンジニアはコンポーネントが更新された状態でパイプラインを実行する必要があるかもしれない。次の backfilling が必要となる状況例として、データ関連の問題を解決するために、既存のデータの新しいバージョンに対してパイプラインを実行することが考えられる。これらの backfill は継続的学習のために直交である必要がある。実例では、エンジニアは手作業で学習ジョブを実行可能であり、モデルが生成後、そのモデルは自動的にモデルの評価と検証が実行が可能である。\nThe TFX User Guide ではまだ継続的機械学習パイプラインを公開できていないが、この公開に向けて我々は動き続けている。 参考: RFC: TFX Advanced DSL semantics #253\nInfrastructure Building On The Shoulders Of Giants 野心的な目標実現のために、強固な基盤を作る必要がある。TFX は Sibyl のシステムデザインの多くを再利用を行った。\n Sibyl のアルゴリズムとワークフローは MapReduce を基に実現されていたが、TFX は TensorFlow, Apache Beamを使って、分散学習とデータ処理のワークフローを実現した Sybyl はカラムベースのデータ管理を行っていたが、Apache arrow によりインメモリでのカラムベースのデータ管理に適合した。  また、頑強な標準化が進んでいる箇所では、依存性をあえてもたせることにより TFX とその使用者にパフォーマンスとスケーラビリティを提供することに成功した。例えば、TFX の依存先でもあるKubeflow Pipelines や Apache Airflow はそれらを使用する利益が依存先の管理に勝ると判断されたので選択されました。\nInteroperability And Positive Externalities 機械学習基盤は孤立した環境で運用されるのではなく、既存のデータ基盤からの ETL やシステムへのモデルのデプロイなどの相互運用を意識する必要がある。\n Google Ads で Sibyl が相互運用されていたのと同じく、TFX では複数のサービスからのデータの ETL、サービングが複数の開発環境やデバイスに提供している Sibyl で Google 社内技術で相互運用されていたのと同様に、TFX は Apache Beamは Apache Flink や Apache Spark のクラスターやGoogle Cloud Dataflow などのサーバーレスデータ処理を実行するために活用されている TFX はオーケストレーション機能の抽象化を MLMD を用いて実現し Apache Airflow, Apache Beam, Kubeflow Pipelines も選択肢の一つとして採用できるようにしている  上記で説明したように、運用が簡単になるような技術群を採用しており既存のデータ基盤との接続や、サービングなどが Alphabet 外でも容易に構築可能になっている。\nまた複数の技術の組み合わせは指数関数的に開発環境の設定が増加するため、マネージドサービスである Could AI Platform Pipelines も提供を開始した。\nWhat Is Different And Why ここでは、TFX を現実的な問題に適応するために変化させた部分を説明する。\nEnvironment And Device Portability Sibyl は Google での大規模クラスタである Borg へのデプロイを前提にデザインされていた。当初、Google での機械学習適用についてこれで問題なかったが、世界的に機械学習技術の発展に伴い、Google 外部かつ大規模だけではない小規模な環境へのデプロイの必要性も高まった。その結果、ポータビリティが重視された機械学習基盤が必要になってきた(が厳密な一貫性を保つことももちろん要求される)。\n Sibyl が Google のデータセンターでのみ動くが、TFX はラップトップ、ワークステーション、外部のデータセンター、クラウド上で実行することができる。特にGoogle Cloud では最適化と自動化された TFX が提供される Sibyl は CPU でのみ動くが、TFX は異なるハードウェア(CPU, GPU, TPU )で動く Sibyl で作成されたモデルはサーバー上での実行のみ可能だが、TFX はラップトップ、サーバー、TensorFlow Serving, Apache Beam、モバイルや IOT では TensorFlow Lite, ブラウザ上では TensorFlow JSによって実行可能である  小規模から大規模な問題を解くために、TFX のポータビリティ性は洗練され多種多様な環境、デバイスでの実行を可能にしている。\nだがポータビリティはコストも高くなってしまう。メンテンスを行う際に、環境固有もしくはデバイス固有の特殊な要求を満たす必要があり、環境やデバイスの数が増えるとそれらは超線形にコストが増加する。が、一般の使用者はそれらのメンテンスコストは意識せず TFX を使用することが可能です。\nModularity And Layering Sibyl は既存のプロダクトと密結合され、モノリシックに構成されており、既存の仕様に把握して、それに合わせる必要があった。対象的に TFX はモジュラー化とレイヤー化が意識されたアーキテクチャ設計になっており、チーム間で連携しつつ開発を行えるようになっている。\nTFX のレイヤーデザイン\n ML Service  Cloud AutoML Cloud Recommendations AI Cloud AI Platform Cloud Dataflow Cloud BigQuery   Pipelines  TensorFlow Extended   Binaries  TensorFlow Serving   Libraries  TensorFlow DataValidation TensorFlow Transform TensorFlow Hub TensorFlow Model Analysis TFX Basic Shared Libraries ML Metadata    TFX のレイヤーアーキテクチャは、使用者の必要性に合わせて、開発者にはライブラリから、パイプライン、エンドユーザー向けには ML Service などを提供可能にしている。\nMulti-faceted Flexibility Sibyl は開発当初は他の利用可能なツールに比べると、柔軟性があったが機械学習ワークフローの高速化の需要に答えることができなかったことも TFX の開発に繋がった。\n Sibyl は特定のデータ解析しか提供していなかったが、TFX は TensorFlow DataValidation により柔軟なデータ分析が可能になっている Sibyl は特定の mappers しか提供していなかったが、TFX は TensorFlow Transform により、カスタマイズ可能な柔軟性に長けた mappers, analyzers が使用可能になっている Sibyl は非深層学習のみサポートしていたが、TFX は Trainer Component により TensorFlow ベースのモデルを提供可能になっており、TensorFlow Hub などで転移学習なども容易に行えるようになっている Sibyl は非深層学習モデルに対する自動的な特徴量の組み合わせ(feature conjunction) のみ提供していたが、TFX では Tuner component により state of the art ベースのハイパーパラメータチューニングが利用可能になっている Sibyl は特定のモデルの解析手法しか提供していなかったが、TFX は TensorFlow Model Analysis により、Evaluator Component をベースにビルトインのメトリクスなど多様なモデル解析手法を提供している Sibyl は 固定されたパイプラインしか扱えなかったが、TFX はカスタムコンポーネントが使用可能であり、柔軟にパイプラインを設計可能である  Where We Are Going 2020 年において、TFX の開発はroadmap、 RFC、 Contribution guideline を基に進めています。我々は応用機械学習の普及のために、機械学習エンジニアリングのさらなる発展に尽力し、responsible AI (TensorFlow を用いた高い信頼性を持つ機械学習開発のための方法論)をGoogle の AI 原則論 に基づき実世界へ適用していく。\nDrive Interoperability And Standards 相互運用性を高め、我々は原則論である、社会に利益をもたらすことを意識していく。我々のミッションとして、我々は OSS による先進的な機械学習システム構築をサポートし、機械学習による生成物の標準化も行っていく。例えば具体例として上げると\n TFX standardized input TFX DSL semantics, Data model and IR 標準化された機械学習生成物とメタデータ 多様な実行環境での分散実行環境の標準化 分散かつストリーミングでのモデルの推論 モバイルやエッジでの相互運用を意識した改善 相互運用を意識した機械学習フレームワークの改善  Increase Automation 自動化こそ、高信頼性のプロダクションシステムの柱となる考えであり、TFX は自動化にとてつもなく投資を行っている。我々の原則論である”安全のためのビルドとテスト”、””\nTFX pipeline では開発が進むことで、 TFX Tuner によるモデルの自動改善や、教師あり学習のモデルの多次元でのスライスでの挙動の自動検知、Model Cards の自動生成もサポート、training-serving skew の自動検知も開始された。GCP での TFX は先進的な機能が提供されていく。\nImprove ML Understanding 機械学習を理解することは、プロダクション環境下に機械学習を適用する際に重要な側面の一つである。機械学習を理解するためにはモデル作成に付随する生成物の追跡( lineage) は最も重要事項の一つである。struct2tensor (TensorFlow 内部の構造化データのパーシングライブラリ)は構造化データにおいて、学習やサービング、解析においてより役立つ TFX の技術の一つである。\nUphold High Standards And Best Practices 高水準の標準化とベストプラクティスの共有のために、TFX チームはこれからも科学的論文の執筆・公開を継続していくことで Alphabet 外にもこのベストプラクティスが普及することを狙っていく。AutoML pipelines のベンチマークツールとしてNitroMLも再現性の鍵の一つとなる。\nImprove Tooling TFX は機械学習エンジニアリングと機械学習ライフサイクルのいくつもの段階のためのツールを提供しており、いまだこの領域は黎明期であることを願っている。\n大規模かつ重要度が高いストリーミングかつレイテンシーが要求されるデータは挑戦的な課題である。TFX では Apache Beam と Cloud Dataflow の実行によりストリーミングイベントにも対応した予測を実行可能になっている。我々はこの枠組みを TensorFlow Serving でも同等のことが行えないか計画している。\n更に、たくさんのツールが機械学習ワークフローでもまだ自動化が必要とされているものが多い。例えば、機械学習パイプライン実行時に、そのジョブの結果が現行のモデルよりもパフォーマンスが低いことを積極的に予測しジョブの実行を停止することで、大幅なリソースと実行時間の削減が期待できる。\nA Joint Journey TFX の構築は、機械学習エンジニアリングの基礎の探索でもあり、多くの人々の長年の努力の累積である。\nさあ、我々もあなたを\"機械学習エンジニアリングに向けた” 旅に招待します。\n","wordCount":"823","inLanguage":"ja","datePublished":"2021-01-17T00:18:47+09:00","dateModified":"2022-04-08T23:06:50+09:00","author":{"@type":"Person","name":"Shunya Ueta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shunyaueta.com/posts/2021-01-17/"},"publisher":{"@type":"Organization","name":"🦅 hurutoriya","logo":{"@type":"ImageObject","url":"https://shunyaueta.com/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://shunyaueta.com/ accesskey=h title="🦅 hurutoriya (Alt + H)">🦅 hurutoriya</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://shunyaueta.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://shunyaueta.com/about title=About><span>About</span></a></li><li><a href=https://shunyaueta.com/index.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>TFXの歴史を振り返りつつ機械学習エンジニアリングを提案する論文「Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)」</h1><div class=post-meta><span title="2021-01-17 00:18:47 +0900 +0900">January 17, 2021</span>&nbsp;·&nbsp;Shunya Ueta&nbsp;|&nbsp;<a href=https://github.com/hurutoriya/hurutoriya.github.io/tree/source/content/posts/2021-01-17/index.md rel="noopener noreferrer" target=_blank>Edit this post (この記事を編集する)</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目次</span></summary><div class=inner><ul><li><a href=#citation aria-label=Citation>Citation</a><ul><li><a href=#tfx-%e3%82%92%e7%9f%a5%e3%82%89%e3%81%aa%e3%81%84%e6%96%b9%e5%90%91%e3%81%91 aria-label="TFX を知らない方向け">TFX を知らない方向け</a></li></ul></li><li><a href=#%e6%8a%84%e8%a8%b3 aria-label=抄訳>抄訳</a><ul><li><a href=#abstract aria-label=Abstract>Abstract</a></li><li><a href=#where-we-are-coming-from aria-label="Where We Are Coming From">Where We Are Coming From</a></li><li><a href=#sibyl-2002-2020 aria-label="Sibyl 2002-2020">Sibyl 2002-2020</a></li><li><a href=#tfx-2017--- aria-label="TFX (2017 - ?)">TFX (2017 - ?)</a></li><li><a href=#lessons-from-our-10-year-journey-of-ml-platform-evolution aria-label="Lessons From Our 10+ Year Journey Of ML Platform Evolution">Lessons From Our 10+ Year Journey Of ML Platform Evolution</a></li><li><a href=#what-remains-the-same-and aria-label="What Remains The Same And">What Remains The Same And</a></li><li><a href=#applied-ml aria-label="Applied ML">Applied ML</a></li><li><a href=#the-discipline-of-ml-engineering aria-label="The Discipline Of ML Engineering">The Discipline Of ML Engineering</a><ul><li><a href=#data aria-label=Data>Data</a></li><li><a href=#models-%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92%e3%83%a2%e3%83%87%e3%83%ab aria-label="Models (機械学習モデル)">Models (機械学習モデル)</a></li></ul></li><li><a href=#mergeable-fragments aria-label="Mergeable Fragments">Mergeable Fragments</a></li><li><a href=#artifact-lineage-%e7%94%9f%e6%88%90%e7%89%a9%e3%81%ae%e7%b5%8c%e8%b7%af%e8%bf%bd%e8%b7%a1 aria-label="Artifact Lineage (生成物の経路追跡)">Artifact Lineage (生成物の経路追跡)</a></li><li><a href=#continuous-learning-and-unlerning aria-label="Continuous Learning And Unlerning">Continuous Learning And Unlerning</a></li><li><a href=#infrastructure aria-label=Infrastructure>Infrastructure</a></li><li><a href=#building-on-the-shoulders-of-giants aria-label="Building On The Shoulders Of Giants">Building On The Shoulders Of Giants</a></li><li><a href=#interoperability-and-positive-externalities aria-label="Interoperability And Positive Externalities">Interoperability And Positive Externalities</a></li></ul></li><li><a href=#what-is-different-and-why aria-label="What Is Different And Why">What Is Different And Why</a><ul><li><a href=#environment-and-device-portability aria-label="Environment And Device Portability">Environment And Device Portability</a></li><li><a href=#modularity-and-layering aria-label="Modularity And Layering">Modularity And Layering</a></li><li><a href=#multi-faceted-flexibility aria-label="Multi-faceted Flexibility">Multi-faceted Flexibility</a></li></ul></li><li><a href=#where-we-are-going aria-label="Where We Are Going">Where We Are Going</a><ul><li><a href=#drive-interoperability-and-standards aria-label="Drive Interoperability And Standards">Drive Interoperability And Standards</a></li><li><a href=#increase-automation aria-label="Increase Automation">Increase Automation</a></li><li><a href=#improve-ml-understanding aria-label="Improve ML Understanding">Improve ML Understanding</a></li><li><a href=#uphold-high-standards-and-best-practices aria-label="Uphold High Standards And Best Practices">Uphold High Standards And Best Practices</a></li><li><a href=#improve-tooling aria-label="Improve Tooling">Improve Tooling</a></li></ul></li><li><a href=#a-joint-journey aria-label="A Joint Journey">A Joint Journey</a></li></ul></div></details></div><div class=post-content><p>この記事は<a href=https://adventar.org/calendars/5089>MLOps Advent Calendar 2020</a>の 25 日目の記事です。(盛大に遅れました)</p><p>KDD2019 の招待講演で Google が TFX の歴史について発表されており、TFX 信者の自分としては発表内容が以前から気になっていたが、公開はされておらずなんとかして見れないかな~と思っていましたが、<a href=%5Bhttps://blog.tensorflow.org/2020/09/brief-history-of-tensorflow-extended-tfx.html%5D(https://blog.tensorflow.org/2020/09/brief-history-of-tensorflow-extended-tfx.html)>TensorFlow の Blog</a>で該当の招待講演が論文化されたことを知ったのでメモがてら抄訳として残しておく。</p><ul><li><em>注意)この翻訳記事は原著論文の著者陣からレビューはされていません</em></li><li><em>Shunya Ueta, are providing a translation and abridgment, which has not been reviewed by the authors.</em></li></ul><h2 id=citation>Citation<a hidden class=anchor aria-hidden=true href=#citation>#</a></h2><hr><p>Karmarkar, A., Altay, A., Zaks, A., Polyzotis, N., Ramesh, A., Mathes, B., … & Li, Z. (2020). Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX). arXiv preprint arXiv:2010.02013. ***</p><ul><li><a href=https://www.kdd.org/kdd2019/applied-data-science-invited-speakers/view/towards-ml-engineering-with-tensorflow-extended-tfx>Towards ML Engineering with TensorFlow Extended (TFX) at KDD2019</a></li><li><a href=https://dl.acm.org/doi/abs/10.1145/3292500.3340408>Towards ML Engineering with TensorFlow Extended (TFX) ACM</a></li><li>PDF は arxiv でも閲覧可能<ul><li><a href=https://arxiv.org/abs/2010.02013>https://arxiv.org/abs/2010.02013</a></li></ul></li></ul><h3 id=tfx-を知らない方向け>TFX を知らない方向け<a hidden class=anchor aria-hidden=true href=#tfx-を知らない方向け>#</a></h3><p><a href=(https://www.tensorflow.org/tfx)>TFX</a>とは、Google が開発する TensorFlow Extended(TFX)の略称で、Google 社内で開発された TensorFlow を基にした機械学習基盤のプロジェクト。 TFX の各コンポーネントは OSS として公開されている。</p><h2 id=抄訳>抄訳<a hidden class=anchor aria-hidden=true href=#抄訳>#</a></h2><h3 id=abstract>Abstract<a hidden class=anchor aria-hidden=true href=#abstract>#</a></h3><p>ソフトウェアエンジニアリングは成熟しつつあるが、一方で機械学習エンジニアリングはまだ成熟しきっていない。この論文では Alphabet で成功しているエンドツーエンドの機械学習基盤である Sybil, TFX の紹介を行う。主に TFX が機械学習エンジニアリングの実現にどう役立つかについて紹介していく。そして我々は機械学習による恩恵を受けるために、まずは機械学習チームの成熟と強固なインフラストラクチャ、組織内での教育活動が同時に必要であることを主張する。また、先進的なモデル開発を行う前に、容易に相互運用可能な機械学習基盤導入を強くすすめる。</p><h3 id=where-we-are-coming-from>Where We Are Coming From<a hidden class=anchor aria-hidden=true href=#where-we-are-coming-from>#</a></h3><h3 id=sibyl-2002-2020>Sibyl 2002-2020<a hidden class=anchor aria-hidden=true href=#sibyl-2002-2020>#</a></h3><p>2007 年から<a href=https://www.datanami.com/2014/07/17/inside-sibyl-googles-massively-parallel-machine-learning-platform/>Sibyl</a> は運用開始されており、2020 年まで運用されていた。最近では開発は廃止され、TFX に移行中であり、主に非深層学習をサポートする機械学習基盤である。</p><p>TFX と同等のミドルウェアである Data Ingestion, Data Analysis and Validation, Training (of course), Model Analysis, and Training-Serving Skew Detection を解決するコンポーネントが存在している。</p><p>(といっても Sibyl は TFX の先祖みたいなものなので、TFX がこれらの機能を踏襲してると考えるのが正しそうですね)</p><h3 id=tfx-2017--->TFX (2017 - ?)<a hidden class=anchor aria-hidden=true href=#tfx-2017--->#</a></h3><p>2015 年からは深層学習の台頭により、TensorFlow がリリースされた。TensorFlow の課題点としてエンドツーエンドの機械学習基盤としては提供されてはいないことである。Sibyl は逆に深層学習用途に対する柔軟性が足りていないのが欠点であり、それらを補うために TFX の開発を開始したのは 2017 年のことだった。偶然にも TFX は Sibyl 誕生から約十年後に開発されことになった。</p><p>TFX の運用開始から 3 年、Alphabet 内で TFX は企業レベルの機械学習基盤として数千のユーザーから使われており、数百の Alphabet (GCP 含む) の機械学習プロダクトを支えている。毎日数千の TFX のパイプラインが稼働し、エクサスケールのデータとともに数万ものモデルが生み出されており、TFX が提供する推論のリクエスト数は秒間数百万超えの規模になっている。TFX により Alphabet 内の研究成果がより早くプロダクションにリリースされ、機械学習基盤の開発よりもモデル開発に集中することが可能になった。</p><p>TensorFlow が Alphabet 内部、そして外部でも人気と衝撃を与えたのと同じく、機械学習エンジニアから TFX にも人気と衝撃が走った。外部の機械学習エンジニアからの要望を叶えるために我々は TFX を徐々に OSS で公開していった。TFX, sibyl は Google 内部の強固なインフラストラクチャから構成されており、そのおかげで OSS での公開が加速した。例えば Sibyl は MapReduce と Flume を使ったデータ処理を行っており、TFX は同じくポータビリティ性の高い Apache beam をベースにしているので OSS での公開がスムーズに進んだ。</p><p>TFX は最終的に 2019 年の頭に OSS として公開され、オンプレスミスや GCP の Cloud AI Platform Pipelines などで活用可能になった。パートナー企業も TFX を活用し始めており、実践的な機械学習の開発速度が改善されはじめている。</p><p>参考文献: <a href=https://engineering.atspotify.com/2019/12/13/the-winding-road-to-better-machine-learning-infrastructure-through-tensorflow-extended-and-kubeflow/>The Winding Road to Better Machine Learning Infrastructure Through Tensorflow Extended and Kubeflow</a></p><h3 id=lessons-from-our-10-year-journey-of-ml-platform-evolution>Lessons From Our 10+ Year Journey Of ML Platform Evolution<a hidden class=anchor aria-hidden=true href=#lessons-from-our-10-year-journey-of-ml-platform-evolution>#</a></h3><p>Google での機械学習基盤の進化の旅は長くそしてワクワクするものであり、ぜひとも我々が学んだことをここで共有したい。</p><p>我々が学んだことは大きく 2 つに分類される。</p><p>この長い旅で</p><ol><li>何が変わり</li><li>何が変わらなかったのか</li></ol><p>だ。Sibyl と TFX の開発を通じで学んだことを共有するが、Google 外部での機械学習基盤開発にも適用可能だと我々は信じている。</p><h3 id=what-remains-the-same-and>What Remains The Same And<a hidden class=anchor aria-hidden=true href=#what-remains-the-same-and>#</a></h3><p>何が変わらず、そしてなぜそれが残ったのか この章では Sibyl, TFX の両者の長期間の運用期間にも耐えることができた機械学習とインフラストラクチャの観点についてまず説明を行う。</p><h3 id=applied-ml>Applied ML<a hidden class=anchor aria-hidden=true href=#applied-ml>#</a></h3><p><a href=https://developers.google.com/machine-learning/guides/rules-of-ml#ml_phase_i_your_first_pipeline>Rules of Machine Learning</a> という Google 内部での機械学習プロダクト開発で学んだ経験則を我々は公開している。</p><p><em>Rules of Machine Learning の一例</em></p><ol><li>シンプルなルールベースとヒューリスティックから開発をまずはじめ、そこからデータを生み出し学びを深めよう。基本的にはここでルールベースのサービングシステムを開発する。</li><li>次に単純な機械学習モデルに移行することで、大きな利益を実現させます。ここでやっと機械学習パイプラインが導入される。</li><li>特徴量を増やし機械学習モデルも先進的なものを適用してみる。</li><li>SOTA を達成した機械学習モデルを適用してみまる(管理コストは増大しパイプラインも複雑になるが、それに見合った価値があることが前提である。)</li><li>上記のサイクルを念頭に置いて機械学習プロダクトの開発に役立ててみよう。そして常に費用対効果(ROI)は忘れないようにするのが大事である。</li></ol><p>我々は Rules of Machine Learning がたとえサービスドメインや稼働する基盤が異なったり、時間が経過したとしても揺るぎない価値があると信じている。特に機械学習エンジニアリングの観点において Rules of Machine Learning は我々とその読者の致命的な失敗を避ける助けになると信じており、TFX は上記の流れを極めて高速に試行するのに役立つ。</p><h3 id=the-discipline-of-ml-engineering>The Discipline Of ML Engineering<a hidden class=anchor aria-hidden=true href=#the-discipline-of-ml-engineering>#</a></h3><p>Rules of Machine Learning の作成を通じ、我々はソフトウェアエンジニアリングを基にした複雑なコードとデータの処理が実行可能な頑強なシステムの理念を学んだ。ここで我々は機械学習エンジニアリングを以下のように定義する。</p><ul><li>機械学習エンジニアリングの定義: ソフトウェアエンジニアリングを包含する形での実践的な機械学習の複雑性を制御するための学問</li></ul><p>実際、機械学習エンジニアリングのすべてをまとめようとするのは、なかなか難しいが</p><ul><li>我々の持っている限られた理解していることは、プラットフォームと時間を超えてうまく稼働している</li><li>過去から学び、相似のものとしてみなすことは強力なアプローチであり、ソフトウェアエンジニアリングの様々な視点は、機械学習エンジニアリングにより機械学習プログラミングをどう進化させれるかが分かる</li></ul><p>参考書籍: <a href>Software Engineering at Google: Lessons Learned from Programming over Time</a></p><p>TFX に関する基礎的な考えは、<a href=https://research.google/pubs/pub46484/>TFX: A TensorFlow-Based Production-Scale Machine Learning Platform</a> にて公開されており、現在 <a href=%5Bhttps://www.tensorflow.org/tfx/guide/mlmd%5D(https://www.tensorflow.org/tfx/guide/mlmd)>ML metadata</a> を軸にして OSS として公開されている。</p><p>では、これから機械学習エンジニアリングの基礎的な要素について、ソフトウェアエンジニアリングとの相似を基に説明を行う。</p><h4 id=data>Data<a hidden class=anchor aria-hidden=true href=#data>#</a></h4><p>ソフトウェアの中心がコードであるように、データは機械学習の中心的な存在である。データマネジメントはプロダクション環境での機械学習適用において挑戦的な課題である。</p><p>参考文献: <a href=https://research.google/pubs/pub46178/>Data Management Challenges in Production Machine Learning</a></p><p>まずはデータに対するユニットテストを考える。ユニットテストはコードがどのように振る舞うべきかを検証する。同様に、データ形式への明示的な期待(スキーマ、不変量や分布)を設定し検証を行うことができる。</p><p>参考文献: <a href=https://research.google/pubs/pub47967/>Data Validation for Machine Learning</a></p><p>コードリポジトリとバージョンコントロールは、コード管理の軸となっている。。データ管理を行うことができるシステムはまた機械学習エンジニアリングでも同様に重要である。TFX の ExampleGen, StasticsGen, SchmaGen と Example Validator の各種コンポーネントにより継続的な機械学習パイプラインのデータ管理、分析、検証が可能になりデータをコードのように扱うために非常に役に立つ。</p><p>参考文献: <a href=%5Bhttps://research.google/pubs/pub48974/%5D(https://research.google/pubs/pub48974/)>TensorFlow DataValidation</a> , <a href=https://www.tensorflow.org/tfx/guide/examplegen>The ExampleGen TFX Pipeline Component</a></p><h4 id=models-機械学習モデル>Models (機械学習モデル)<a hidden class=anchor aria-hidden=true href=#models-機械学習モデル>#</a></h4><p>ソフトウェアエンジニアがコンパイルされたコードを作成するのと同じように、機械学習エンジニアは、データとコードを基に「コンパイル」された機械学習プログラムを作成する。コンパイルされたものが、一般的には機械学習モデルとして知られている。この 2 種類のプログラムの性質は大きく異なっている。ソフトウェアはプログラムを通して一貫性を保つが、機械学習モデルは一貫性を保つことが非常に難しい。またこの一貫性の検証は何かしらの要約された形式でしか検証できない。(例えばラベルデータの部分集合で十分な精度が出ているなどの形でしか機械学習モデルの一貫性の保証ができない)</p><p>コードとデータは時間経過により変化し、モデルもそれに伴い変化する。しかし、モデルの変化はコードやデータの変化に比べて更に複雑になる。例えば、コードに対する高いテストカバレッジはコードの一部の正しさと変化に対する高い信頼性を得ることができるが、モデルに対するテストでは、分布外のデータや因果関係を理解できるデータを作成しテストすることはとても困難である。</p><p>同じく結合テストでも同じ問題が発生し、end-to-end でのモデルの検証と理解が機械学習エンジニアリングの重要な構成要素である。</p><p>参考文献: <a href=%5Bhttps://research.google/pubs/pub47966/%5D(https://research.google/pubs/pub47966/)>Slice Finder: Automated Data Slicing for Model Validation</a></p><p>TFX の evaluator と InfraValidator コンポーネントはモデルの検証と理解についての機能を提供する。これらもまた機械学習エンジニアリングの大事な一要素である。</p><p><a href=https://www.tensorflow.org/tfx/guide/evaluator>The Evaluator TFX Pipeline Component</a></p><h3 id=mergeable-fragments>Mergeable Fragments<a hidden class=anchor aria-hidden=true href=#mergeable-fragments>#</a></h3><p>ソフトウェアエンジニアがプログラムを既存のパッケージを合わせて作成するのと同じように、機械学習エンジニアはコード、データ、解析、モデルの断片を合わせて機械学習パイプラインを構築する。ソフトウェアエンジニアリングと機械学習エンジニアリングの決定的な違いは、コードは不変だが、データは常に揮発性を持ってり、変化する点である。(基本的にデータは常に新しくなり続ける)。例えば、入力データの一部分でも傾向が変化した場合には、それに対応して新しいモデルを作成する必要がある。</p><p>このように作成される生成物は常に mergeable (併合可能) であることは、機械学習パイプラインにおいて重要である。例えば一つのデータセットの統計値の要約は、2 つのデータセットの和集合の統計値を簡単に要約できるように、もう一つのデータセットへ簡単に併合可能であるべきである。またモデルの観点から言えば、一つのモデルの学習を別のモデルへと簡単に転移学習できるようにしておくべきである。</p><p>しかしこれは前章で述べたモデルのテストカバレッジと同じ課題を抱えている。新しくモデルにフラグメントをマージすると、分布外データや反実仮想の評価データの作成が必要になる可能性があり、それによってモデルの複雑性があがってしまう。</p><p>TFX の Example Gen, Transform, Trainer, Tuner のコンポーネントは<a href=https://www.tensorflow.org/hub/overview>TensorFlow Hub</a> で管理され、併合可能なパイプラインを作成することに役立ちます。</p><h3 id=artifact-lineage-生成物の経路追跡>Artifact Lineage (生成物の経路追跡)<a hidden class=anchor aria-hidden=true href=#artifact-lineage-生成物の経路追跡>#</a></h3><p>ソフトウェアエンジニアリングは方法論やツールなどが高度に発展しているが、それでも常にデバッグが必要である。それは機械学習プログラムも同様の課題があるが、ソフトウェアエンジニアリングと比べると一段と難易度が増す。なぜなら、機械学習プログラムではプログラムに付随する生成物が難易度への影響を与えている。モデルのデバッグを行う際にコードの欠陥、学習アルゴリズム、学習データ、サービングパス、サービングされるデータなどいくつものエラー原因があり、それらが原因で精度の低下につながる。ソフトウェア開発において、根本原因を探すためにスタックトレースが重要なように、機械学習パイプラインではすべての生成物の生産と消費の追跡が機械学習モデルの精度劣化の根本原因の解明に役立つ。</p><p>TFX では<a href=https://www.tensorflow.org/tfx/guide/mlmd>ML Metadata (MLMD)</a> を使用して、生成物を管理している。MLMD は、生成物のメタデータ管理と追跡を可能にし、機械学習パイプライン外に高い信頼性を持って生成物の管理が可能になる。</p><h3 id=continuous-learning-and-unlerning>Continuous Learning And Unlerning<a hidden class=anchor aria-hidden=true href=#continuous-learning-and-unlerning>#</a></h3><p>プロダクション環境下での機械学習パイプラインは、動的な環境下で以下の特徴がある。</p><ul><li>定期的に新しいデータが到来する</li><li>モデルのコードは、初期段階では頻繁に変化する</li><li>インフラ面も変化する</li></ul><p>もし上記の変化が発生した場合、パイプラインはそれらに対して追従する必要があり、変更後の環境でパイプラインを新たに実行する必要がある。パイプライン実行の監視は、デバッグと原因究明の解析にとても有用である。例えば単純な例では、モデルの失敗原因をデバッグするためには、どのデータが学習済のモデルに使われたかだけではなく、モデルコードとパッケージのバージョンの把握が必要不可欠である。</p><p>機械学習パイプラインはそれらの変化に対して対応できる仕組みが必要である。例えば新しいデータが到来した際には、モデルの再学習が必須である。これらは推薦システムや広告関係などのように迅速に変化する環境においてごく自然に要求される。もしデータが頻繁かつ定期的に変化する環境だった場合、エンジニアが手作業でモデルの再学習を実行することが要求されているならそれは非現実的である。その代わりに TFX はパイプラインが新規のデータを検知して、モデルの再学習を行うことで継続的学習を実現し、手作業を自動化することができる。その自動化を実現するためには高度なオーケストレーションが必要である。また機械学習パイプラインは、何年間もコードとデータを取り込み、継続的に意思決定に役立つ予測を行うモデルを作成するのが一般的である。</p><p>参考文献: <a href=https://research.google/pubs/pub47978/>Continuous Training for Production ML in the TensorFlow Extended (TFX) Platform</a></p><p>次に機械学習パイプラインのために必要とされる仕組みの例では、backfilling 機能がある。例えば、モデルのパッケージやコードは更新済のものを既存のデータに適用するケースなど、エンジニアはコンポーネントが更新された状態でパイプラインを実行する必要があるかもしれない。次の backfilling が必要となる状況例として、データ関連の問題を解決するために、既存のデータの新しいバージョンに対してパイプラインを実行することが考えられる。これらの backfill は継続的学習のために直交である必要がある。実例では、エンジニアは手作業で学習ジョブを実行可能であり、モデルが生成後、そのモデルは自動的にモデルの評価と検証が実行が可能である。</p><p><a href=https://www.tensorflow.org/tfx/guide>The TFX User Guide</a> ではまだ継続的機械学習パイプラインを公開できていないが、この公開に向けて我々は動き続けている。 参考: <a href=https://github.com/tensorflow/community/pull/253>RFC: TFX Advanced DSL semantics #253</a></p><h3 id=infrastructure>Infrastructure<a hidden class=anchor aria-hidden=true href=#infrastructure>#</a></h3><h3 id=building-on-the-shoulders-of-giants>Building On The Shoulders Of Giants<a hidden class=anchor aria-hidden=true href=#building-on-the-shoulders-of-giants>#</a></h3><p>野心的な目標実現のために、強固な基盤を作る必要がある。TFX は Sibyl のシステムデザインの多くを再利用を行った。</p><ul><li>Sibyl のアルゴリズムとワークフローは MapReduce を基に実現されていたが、TFX は TensorFlow, <a href=https://beam.apache.org/>Apache Beam</a>を使って、分散学習とデータ処理のワークフローを実現した</li><li>Sybyl はカラムベースのデータ管理を行っていたが、<a href=https://arrow.apache.org/>Apache arrow</a> によりインメモリでのカラムベースのデータ管理に適合した。</li></ul><p>また、頑強な標準化が進んでいる箇所では、依存性をあえてもたせることにより TFX とその使用者にパフォーマンスとスケーラビリティを提供することに成功した。例えば、TFX の依存先でもある<a href=https://www.kubeflow.org/docs/pipelines/overview/pipelines-overview/>Kubeflow Pipelines</a> や <a href=https://airflow.apache.org/>Apache Airflow</a> はそれらを使用する利益が依存先の管理に勝ると判断されたので選択されました。</p><h3 id=interoperability-and-positive-externalities>Interoperability And Positive Externalities<a hidden class=anchor aria-hidden=true href=#interoperability-and-positive-externalities>#</a></h3><p>機械学習基盤は孤立した環境で運用されるのではなく、既存のデータ基盤からの ETL やシステムへのモデルのデプロイなどの相互運用を意識する必要がある。</p><ul><li>Google Ads で Sibyl が相互運用されていたのと同じく、TFX では複数のサービスからのデータの ETL、サービングが複数の開発環境やデバイスに提供している</li><li>Sibyl で Google 社内技術で相互運用されていたのと同様に、TFX は <a href=https://beam.apache.org/>Apache Beam</a>は <a href=https://flink.apache.org/>Apache Flink</a> や <a href=https://spark.apache.org/>Apache Spark</a> のクラスターや<a href=https://cloud.google.com/dataflow/>Google Cloud Dataflow</a> などのサーバーレスデータ処理を実行するために活用されている</li><li>TFX はオーケストレーション機能の抽象化を MLMD を用いて実現し Apache Airflow, Apache Beam, Kubeflow Pipelines も選択肢の一つとして採用できるようにしている</li></ul><p>上記で説明したように、運用が簡単になるような技術群を採用しており既存のデータ基盤との接続や、サービングなどが Alphabet 外でも容易に構築可能になっている。</p><p>また複数の技術の組み合わせは指数関数的に開発環境の設定が増加するため、マネージドサービスである <a href=https://cloud.google.com/blog/products/ai-machine-learning/introducing-cloud-ai-platform-pipelines>Could AI Platform Pipelines</a> も提供を開始した。</p><h2 id=what-is-different-and-why>What Is Different And Why<a hidden class=anchor aria-hidden=true href=#what-is-different-and-why>#</a></h2><p>ここでは、TFX を現実的な問題に適応するために変化させた部分を説明する。</p><h3 id=environment-and-device-portability>Environment And Device Portability<a hidden class=anchor aria-hidden=true href=#environment-and-device-portability>#</a></h3><p>Sibyl は Google での大規模クラスタである <a href=https://research.google/pubs/pub43438/>Borg</a> へのデプロイを前提にデザインされていた。当初、Google での機械学習適用についてこれで問題なかったが、世界的に機械学習技術の発展に伴い、Google 外部かつ大規模だけではない小規模な環境へのデプロイの必要性も高まった。その結果、ポータビリティが重視された機械学習基盤が必要になってきた(が厳密な一貫性を保つことももちろん要求される)。</p><ul><li>Sibyl が Google のデータセンターでのみ動くが、TFX はラップトップ、ワークステーション、外部のデータセンター、クラウド上で実行することができる。特に<a href=https://cloud.google.com/>Google Cloud</a> では最適化と自動化された TFX が提供される</li><li>Sibyl は CPU でのみ動くが、TFX は異なるハードウェア(CPU, GPU, <a href=https://cloud.google.com/tpu>TPU</a> )で動く</li><li>Sibyl で作成されたモデルはサーバー上での実行のみ可能だが、TFX はラップトップ、サーバー、<a href=https://www.tensorflow.org/tfx/guide/serving>TensorFlow Serving</a>, Apache Beam、モバイルや IOT では <a href=https://www.tensorflow.org/lite/guide>TensorFlow Lite,</a> ブラウザ上では <a href=https://www.tensorflow.org/js/tutorials>TensorFlow JS</a>によって実行可能である</li></ul><p>小規模から大規模な問題を解くために、TFX のポータビリティ性は洗練され多種多様な環境、デバイスでの実行を可能にしている。</p><p>だがポータビリティはコストも高くなってしまう。メンテンスを行う際に、環境固有もしくはデバイス固有の特殊な要求を満たす必要があり、環境やデバイスの数が増えるとそれらは超線形にコストが増加する。が、一般の使用者はそれらのメンテンスコストは意識せず TFX を使用することが可能です。</p><h3 id=modularity-and-layering>Modularity And Layering<a hidden class=anchor aria-hidden=true href=#modularity-and-layering>#</a></h3><p>Sibyl は既存のプロダクトと密結合され、モノリシックに構成されており、既存の仕様に把握して、それに合わせる必要があった。対象的に TFX はモジュラー化とレイヤー化が意識されたアーキテクチャ設計になっており、チーム間で連携しつつ開発を行えるようになっている。</p><p>TFX のレイヤーデザイン</p><ul><li>ML Service<ul><li><a href=https://cloud.google.com/automl>Cloud AutoML</a></li><li><a href=https://cloud.google.com/recommendations>Cloud Recommendations AI</a></li><li><a href=https://cloud.google.com/blog/products/ai-machine-learning/introducing-cloud-ai-platform-pipelines>Cloud AI Platform</a></li><li><a href=https://cloud.google.com/dataflow>Cloud Dataflow</a></li><li><a href=https://cloud.google.com/bigquery>Cloud BigQuery</a></li></ul></li><li>Pipelines<ul><li><a href=https://www.tensorflow.org/tfx>TensorFlow Extended</a></li></ul></li><li>Binaries<ul><li><a href=https://research.google/pubs/pub46801/>TensorFlow Serving</a></li></ul></li><li>Libraries<ul><li><a href=https://github.com/tensorflow/data-validation>TensorFlow DataValidation</a></li><li><a href=https://github.com/tensorflow/transform>TensorFlow Transform</a></li><li><a href=https://github.com/tensorflow/hub>TensorFlow Hub</a></li><li><a href=https://github.com/tensorflow/model-analysis>TensorFlow Model Analysis</a></li><li><a href=https://github.com/tensorflow/tfx-bsl>TFX Basic Shared Libraries</a></li><li><a href=https://github.com/google/ml-metadata>ML Metadata</a></li></ul></li></ul><p>TFX のレイヤーアーキテクチャは、使用者の必要性に合わせて、開発者にはライブラリから、パイプライン、エンドユーザー向けには ML Service などを提供可能にしている。</p><h3 id=multi-faceted-flexibility>Multi-faceted Flexibility<a hidden class=anchor aria-hidden=true href=#multi-faceted-flexibility>#</a></h3><p>Sibyl は開発当初は他の利用可能なツールに比べると、柔軟性があったが機械学習ワークフローの高速化の需要に答えることができなかったことも TFX の開発に繋がった。</p><ul><li>Sibyl は特定のデータ解析しか提供していなかったが、TFX は TensorFlow DataValidation により柔軟なデータ分析が可能になっている</li><li>Sibyl は特定の mappers しか提供していなかったが、TFX は TensorFlow Transform により、カスタマイズ可能な柔軟性に長けた mappers, analyzers が使用可能になっている</li><li>Sibyl は非深層学習のみサポートしていたが、TFX は Trainer Component により TensorFlow ベースのモデルを提供可能になっており、TensorFlow Hub などで転移学習なども容易に行えるようになっている</li><li>Sibyl は非深層学習モデルに対する自動的な特徴量の組み合わせ(feature conjunction) のみ提供していたが、TFX では Tuner component により state of the art ベースのハイパーパラメータチューニングが利用可能になっている</li><li>Sibyl は特定のモデルの解析手法しか提供していなかったが、TFX は TensorFlow Model Analysis により、Evaluator Component をベースにビルトインのメトリクスなど多様なモデル解析手法を提供している</li><li>Sibyl は 固定されたパイプラインしか扱えなかったが、TFX はカスタムコンポーネントが使用可能であり、柔軟にパイプラインを設計可能である</li></ul><h2 id=where-we-are-going>Where We Are Going<a hidden class=anchor aria-hidden=true href=#where-we-are-going>#</a></h2><p>2020 年において、TFX の開発は<a href=https://github.com/tensorflow/tfx/blob/master/ROADMAP.md>roadmap</a>、 <a href=https://github.com/tensorflow/tfx/blob/master/RFCs.md>RFC</a>、 <a href=https://github.com/tensorflow/tfx/blob/master/CONTRIBUTING.md>Contribution guideline</a> を基に進めています。我々は応用機械学習の普及のために、機械学習エンジニアリングのさらなる発展に尽力し、<a href=https://www.tensorflow.org/responsible_ai>responsible AI</a> (TensorFlow を用いた高い信頼性を持つ機械学習開発のための方法論)を<a href=https://ai.google/principles/>Google の AI 原則論</a> に基づき実世界へ適用していく。</p><h3 id=drive-interoperability-and-standards>Drive Interoperability And Standards<a hidden class=anchor aria-hidden=true href=#drive-interoperability-and-standards>#</a></h3><p>相互運用性を高め、我々は原則論である、社会に利益をもたらすことを意識していく。我々のミッションとして、我々は OSS による先進的な機械学習システム構築をサポートし、機械学習による生成物の標準化も行っていく。例えば具体例として上げると</p><ul><li><a href=https://github.com/tensorflow/community/blob/master/rfcs/20191017-tfx-standardized-inputs.md>TFX standardized input</a></li><li><a href=https://github.com/tensorflow/community/blob/102bc5f3beb6ff756d147e7cbf88ffb5422a9f5c/rfcs/20200601-tfx-udsl-semantics.md>TFX DSL semantics</a>, <a href=https://github.com/tensorflow/community/pull/271>Data model and IR</a></li><li>標準化された機械学習生成物とメタデータ</li><li>多様な実行環境での分散実行環境の標準化</li><li>分散かつストリーミングでのモデルの推論</li><li>モバイルやエッジでの相互運用を意識した改善</li><li>相互運用を意識した機械学習フレームワークの改善</li></ul><h3 id=increase-automation>Increase Automation<a hidden class=anchor aria-hidden=true href=#increase-automation>#</a></h3><p>自動化こそ、高信頼性のプロダクションシステムの柱となる考えであり、TFX は自動化にとてつもなく投資を行っている。我々の原則論である”安全のためのビルドとテスト”、””</p><p>TFX pipeline では開発が進むことで、 <a href=https://github.com/tensorflow/community/blob/master/rfcs/20200420-tfx-tuner-component.md>TFX Tuner</a> によるモデルの自動改善や、教師あり学習のモデルの多次元でのスライスでの挙動の自動検知、<a href=https://modelcards.withgoogle.com/about>Model Cards</a> の自動生成もサポート、training-serving skew の自動検知も開始された。GCP での TFX は先進的な機能が提供されていく。</p><h3 id=improve-ml-understanding>Improve ML Understanding<a hidden class=anchor aria-hidden=true href=#improve-ml-understanding>#</a></h3><p>機械学習を理解することは、プロダクション環境下に機械学習を適用する際に重要な側面の一つである。機械学習を理解するためにはモデル作成に付随する生成物の追跡( lineage) は最も重要事項の一つである。<a href=https://github.com/google/struct2tensor>struct2tensor</a> (TensorFlow 内部の構造化データのパーシングライブラリ)は構造化データにおいて、学習やサービング、解析においてより役立つ TFX の技術の一つである。</p><h3 id=uphold-high-standards-and-best-practices>Uphold High Standards And Best Practices<a hidden class=anchor aria-hidden=true href=#uphold-high-standards-and-best-practices>#</a></h3><p>高水準の標準化とベストプラクティスの共有のために、TFX チームはこれからも科学的論文の執筆・公開を継続していくことで Alphabet 外にもこのベストプラクティスが普及することを狙っていく。AutoML pipelines のベンチマークツールとして<a href="https://www.youtube.com/watch?v=SagSL38Kx0Q">NitroML</a>も再現性の鍵の一つとなる。</p><h3 id=improve-tooling>Improve Tooling<a hidden class=anchor aria-hidden=true href=#improve-tooling>#</a></h3><p>TFX は機械学習エンジニアリングと機械学習ライフサイクルのいくつもの段階のためのツールを提供しており、いまだこの領域は黎明期であることを願っている。</p><p>大規模かつ重要度が高いストリーミングかつレイテンシーが要求されるデータは挑戦的な課題である。TFX では Apache Beam と Cloud Dataflow の実行によりストリーミングイベントにも対応した予測を実行可能になっている。我々はこの枠組みを TensorFlow Serving でも同等のことが行えないか計画している。</p><p>更に、たくさんのツールが機械学習ワークフローでもまだ自動化が必要とされているものが多い。例えば、機械学習パイプライン実行時に、そのジョブの結果が現行のモデルよりもパフォーマンスが低いことを積極的に予測しジョブの実行を停止することで、大幅なリソースと実行時間の削減が期待できる。</p><h2 id=a-joint-journey>A Joint Journey<a hidden class=anchor aria-hidden=true href=#a-joint-journey>#</a></h2><p>TFX の構築は、機械学習エンジニアリングの基礎の探索でもあり、多くの人々の長年の努力の累積である。</p><p>さあ、我々もあなたを"機械学習エンジニアリングに向けた&rdquo; 旅に招待します。</p><h2>See Also</h2><ul><li><a href=/posts/2020-04-25/>機械学習システムの信頼性を数値化し、技術的負債を解消する論文「 The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction」</a></li><li><a href=/posts/2020-04-19/>機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」</a></li><li><a href=/posts/2018-04-09/>Google, Facebookが提供する機械学習基盤まとめ</a></li><li><a href=/posts/2020-09-06/>MLOps の国際会議 OpML'20 に、機械学習を活用した商品監視の改善に関する論文が採択されたので登壇してきた</a></li><li><a href=/posts/2018-04-24/>[抄訳] Data engineers vs. data scientists</a></li></ul><h2>Support</h2>記事をお読みくださりありがとうございます。このウェブサイトの運営を支援していただける方を募集しています。
もしよろしければ、下のボタンからサポート(投げ銭)していただけると、ブログ執筆、情報発信のモチベーションに繋がります✨
<a href=https://www.buymeacoffee.com/hurutoriya><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=☕&slug=hurutoriya&button_colour=FFDD00&font_colour=000000&font_family=Inter&outline_colour=000000&coffee_colour=ffffff"></a></div><footer class=post-footer><ul class=post-tags><li><a href=https://shunyaueta.com/tags/machinelearning/>machinelearning</a></li><li><a href=https://shunyaueta.com/tags/mlops/>mlops</a></li><li><a href=https://shunyaueta.com/tags/paper/>paper</a></li><li><a href=https://shunyaueta.com/tags/translation/>translation</a></li><li><a href=https://shunyaueta.com/tags/mlengineering/>mlengineering</a></li><li><a href=https://shunyaueta.com/tags/tensorflow/>tensorflow</a></li></ul><nav class=paginav><a class=prev href=https://shunyaueta.com/posts/2021-02-08/><span class=title>« 前のページ</span><br><span>pip 実行時に sys.stderr.write(f"ERROR: {exc} ") とエラーが出てpipを実行できないときの対処方法</span></a>
<a class=next href=https://shunyaueta.com/posts/2020-12-26/><span class=title>次のページ »</span><br><span>PythonでApache beam 入門</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=hurutoriya/hurutoriya.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk2MDgyNTY1Nw==" data-category=Comments data-category-id=DIC_kwDOA6AgOc4CAQTX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=dark data-lang=ja crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2022 <a href=https://shunyaueta.com/>🦅 hurutoriya</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z" /></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerText='copy';function copyingDone(){copybutton.innerText='copied!';setTimeout(()=>{copybutton.innerText='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>