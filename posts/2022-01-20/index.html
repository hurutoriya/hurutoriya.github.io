<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„ | ğŸ¦… hurutoriya</title><meta name=keywords content="bigquery,gcp"><meta name=description content="TL;DR; UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€bqutil.fnã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚
èƒŒæ™¯ SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?
ä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€12345 ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„&mldr;)
GCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§bqutil.fnã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚
ä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½
1  bqutil.fn.typeof()   ã“ã®bqutil.fn ã¯bigquery-utils/udfs/community/ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒbqutil ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®fn ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ bqutil.fn.typeof()ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ é ­è‰¯ã„
 This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries."><meta name=author content="Shunya Ueta"><link rel=canonical href=https://shunyaueta.com/posts/2022-01-20/><link crossorigin=anonymous href=/assets/css/stylesheet.min.f00f189851525f5dc525fa12dfc10fa3656c6cc16f26285e5f7347522031587e.css integrity="sha256-8A8YmFFSX13FJfoS38EPo2VsbMFvJiheX3NHUiAxWH4=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://shunyaueta.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shunyaueta.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shunyaueta.com/favicon-32x32.png><link rel=apple-touch-icon href=https://shunyaueta.com/apple-touch-icon.png><link rel=mask-icon href=https://shunyaueta.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-39994406-11','auto');ga('send','pageview');}</script><meta property="og:title" content="OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„"><meta property="og:description" content="TL;DR; UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€bqutil.fnã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚
èƒŒæ™¯ SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?
ä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€12345 ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„&mldr;)
GCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§bqutil.fnã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚
ä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½
1  bqutil.fn.typeof()   ã“ã®bqutil.fn ã¯bigquery-utils/udfs/community/ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒbqutil ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®fn ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ bqutil.fn.typeof()ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ é ­è‰¯ã„
 This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries."><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2022-01-20/"><meta property="og:image" content="https://shunyaueta.com/posts/2022-01-20/images/1.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-01-20T00:03:07+09:00"><meta property="article:modified_time" content="2022-05-02T23:59:56+09:00"><meta property="og:site_name" content="Shunya Ueta"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/posts/2022-01-20/images/1.png"><meta name=twitter:title content="OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„"><meta name=twitter:description content="TL;DR; UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€bqutil.fnã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚
èƒŒæ™¯ SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?
ä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€12345 ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„&mldr;)
GCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§bqutil.fnã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚
ä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½
1  bqutil.fn.typeof()   ã“ã®bqutil.fn ã¯bigquery-utils/udfs/community/ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒbqutil ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®fn ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ bqutil.fn.typeof()ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ é ­è‰¯ã„
 This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„","item":"https://shunyaueta.com/posts/2022-01-20/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„","name":"OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„","description":"TL;DR; UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€bqutil.fnã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚\nèƒŒæ™¯ SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?\nä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€12345 ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„\u0026hellip;)\nGCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§bqutil.fnã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚\nä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½\n1  bqutil.fn.typeof()   ã“ã®bqutil.fn ã¯bigquery-utils/udfs/community/ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒbqutil ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®fn ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ bqutil.fn.typeof()ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ é ­è‰¯ã„\n This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries.","keywords":["bigquery","gcp"],"articleBody":"TL;DR; UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€bqutil.fnã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚\nèƒŒæ™¯ SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?\nä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€12345 ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„â€¦)\nGCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§bqutil.fnã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚\nä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½\n1  bqutil.fn.typeof()   ã“ã®bqutil.fn ã¯bigquery-utils/udfs/community/ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒbqutil ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®fn ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ bqutil.fn.typeof()ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚ é ­è‰¯ã„\n This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries.\n å®Ÿéš›ã«ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã‚’ Google BigQuery ã§å®Ÿè¡Œã™ã‚‹ã¨\n1 2 3 4 5  SELECT bqutil.fn.typeof(\"\"), bqutil.fn.typeof(b\"\"), bqutil.fn.typeof(1.0), bqutil.fn.typeof(STRUCT()),   1 2 3 4  STRING BYTES FLOAT64 STRUCT   ã®çµæœãŒå‡ºåŠ›ã•ã‚Œã€å„ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã®å‹ã‚’ç¢ºèªã§ãã‚‹ã€‚\nä¾¿åˆ©!\nã“ã‚Œã§ç½®ãæ›ãˆå¯èƒ½ãª UDF ã¯ç½®ãæ›ãˆã‚Œã°ãƒ¡ãƒ³ãƒ†ãƒ³ã‚¹ã—ãªã„ã¨ã„ã‘ãªã„ UDF ãŒå‰Šæ¸›ã•ã‚Œã¦å¬‰ã—ã„ã§ã™ã­\nbqutil.fn.typeof() ã® UDF ã®å®Ÿæ…‹ã¨ã—ã¦ã¯ bigquery-utils/udfs/community/typeof.sqlxãŒå‚ç…§ã•ã‚Œã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã€‚\nä»–ã«ã‚‚\n URL ã® key ã‚’æŠ½å‡ºã§ãã‚‹bqutil.fn.url_keys() ãƒ©ãƒ³ãƒ€ãƒ ãªå€¤ã‚’å‡ºåŠ›ã§ãã‚‹bqutil.fn.url_keys()  ãªã©ã€è‡ªå‰ã§æ­£è¦è¡¨ç¾ã§é ‘å¼µã£ã¦æ›¸ã„ã¦ã„ã‚‹ã‘ã©å®Ÿéš›ã¯ OSS ã® UDF ã¨ã—ã¦å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚å¤šã€…ã‚ã‚Šãã†ãªã‹ã‚†ã„ã¨ã“ã‚ã«æ‰‹ãŒå±Šã UDF ãŒå¤šæ•°å…¬é–‹ã•ã‚Œã¦ã„ãŸã€‚\nå¤‰ã‚ã‚Šç¨®ã¨ã—ã¦ã¯ã€ StatsLib: Statistical UDFsã¨ã„ã†çµ±è¨ˆçš„ãªå‡¦ç†ã‚’è¡Œã† UDF ã‚‚å…¬é–‹ã•ã‚Œã¦ã„ãŸã€‚\nç·šå½¢å›å¸°ã‚„ p å€¤ã®è¨ˆç®—ãŒã§ãã‚‹ UDF ã‚‚å…¬é–‹ã•ã‚Œã¦ãŠã‚Šã€é¢ç™½ã„\nReferences  bigquery type check operator? like typeof in Javascript; or workaround typeof(input ANY TYPE)  ","wordCount":"156","inLanguage":"ja","image":"https://shunyaueta.com/posts/2022-01-20/images/1.png","datePublished":"2022-01-20T00:03:07+09:00","dateModified":"2022-05-02T23:59:56+09:00","author":{"@type":"Person","name":"Shunya Ueta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shunyaueta.com/posts/2022-01-20/"},"publisher":{"@type":"Organization","name":"ğŸ¦… hurutoriya","logo":{"@type":"ImageObject","url":"https://shunyaueta.com/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://shunyaueta.com/ accesskey=h title="ğŸ¦… hurutoriya (Alt + H)">ğŸ¦… hurutoriya</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://shunyaueta.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://shunyaueta.com/about title=About><span>About</span></a></li><li><a href=https://shunyaueta.com/index.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>OSS ã® Google BigQuery UDF `bqutil.fn` ã‚’ä½¿ãˆã° UDF ã®ç‹¬è‡ªå®Ÿè£…ã‚’ç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œãªã„</h1><div class=post-meta><span title="2022-01-20 00:03:07 +0900 +0900">January 20, 2022</span>&nbsp;Â·&nbsp;Shunya Ueta&nbsp;|&nbsp;<a href=https://github.com/hurutoriya/hurutoriya.github.io/tree/source/content/posts/2022-01-20/index.md rel="noopener noreferrer" target=_blank>Edit this post (ã“ã®è¨˜äº‹ã‚’ç·¨é›†ã™ã‚‹)</a></div></header><figure class=entry-cover><img loading=lazy src=https://shunyaueta.com/posts/2022-01-20/images/1.png alt="bqutil.fn.typeof() ã®å®Ÿè¡Œçµæœ"><p>bqutil.fn.typeof() ã®å®Ÿè¡Œçµæœ</p></figure><div class=post-content><h2 id=tldr>TL;DR;<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h2><p>UDF ã‚’ç‹¬è‡ªå®Ÿè£…ã™ã‚‹å‰ã«ã€<code>bqutil.fn</code>ã‚’çœºã‚ã¦ãŠãã¨è»Šè¼ªã®å†ç™ºæ˜ãŒå›é¿ã§ãã‚‹ã‹ã‚‚</p><h2 id=èƒŒæ™¯>èƒŒæ™¯<a hidden class=anchor aria-hidden=true href=#èƒŒæ™¯>#</a></h2><p>SQL ã¯ã€ç‰¹å®šã®å‡¦ç†ã‚’è¡Œã†éš›ã«ãƒ‡ãƒ¼ã‚¿ã®å‹ãŒåŒä¸€ã§ãªã„ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ãŒã€ã‚‚ã¨ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ç´¹ä»‹ã™ã‚‹ã‚ˆã‚Šã‚‚ã‚‚ã£ã¨ãŠæ‰‹è»½ã«ã‚«ãƒ©ãƒ ã®å‹ã‚’ç¢ºèªã—ãŸã„ã¨ããŒã‚ã‚Šã¾ã›ã‚“ã‹?</p><p>ä¾‹ãˆã°ã€å‡ºåŠ›çµæœã‚’è¦‹ãŸã ã‘ã§ã¯ã€<code>12345</code> ãŒ STRING ãªã®ã‹ INT64 ãªã®ã‹åˆ¤åˆ¥ä¸å¯èƒ½ã§ã™ã‚ˆã­ã€‚(ã‚‚ã—åˆ¤åˆ¥å¯èƒ½ãªæ–¹æ³•çŸ¥ã£ã¦ã„ã‚‹äººã„ãŸã‚‰æ•™ãˆã¦ä¸‹ã•ã„&mldr;)</p><h2 id=gcp-ã«ã‚ˆã‚‹-oss-udf-ã®-bqutilfn>GCP ã«ã‚ˆã‚‹ OSS UDF ã® bqutil.fn<a hidden class=anchor aria-hidden=true href=#gcp-ã«ã‚ˆã‚‹-oss-udf-ã®-bqutilfn>#</a></h2><p>ãªã®ã§ãŠæ‰‹è»½ã« BigQuery ã®çµæœã®å‹ã‚’ç¢ºèªã—ãŸã„æ™‚ã«ãªã«ã‹è‰¯ã„æ–¹æ³•ãŒãªã„ã‹ãªã¨èª¿ã¹ã¦ã„ãŸã‚‰ã€OSS ã§<code>bqutil.fn</code>ã¨ã„ã† UDF ãŒ GCP ã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ãŸã€‚</p><p>ä¾‹ãˆã°å‹ã®ç¢ºèªã®å ´åˆã€ä»¥ä¸‹ã® ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é–¢æ•°ï¼ˆUDF) ã¯ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚å®Ÿè¡Œå¯èƒ½</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=n>bqutil</span><span class=p>.</span><span class=n>fn</span><span class=p>.</span><span class=n>typeof</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><p>ã“ã®<code>bqutil.fn</code> ã¯<a href=https://github.com/GoogleCloudPlatform/bigquery-utils/tree/master/udfs/community#typeofinput-any-type>bigquery-utils/udfs/community/</a>ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ UDF ãŒ<code>bqutil</code> ã¨ã„ã† GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®<code>fn</code> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«åŒæœŸã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ã©ã® GCP ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Google BigQuery ã‹ã‚‰å®Ÿè¡Œã—ã¦ã‚‚ <code>bqutil.fn.typeof()</code>ã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã¦ã„ã‚‹ã‚‰ã—ã„ã€‚
é ­è‰¯ã„</p><blockquote><p>This directory contains community contributed user-defined functions to extend BigQuery for more specialized usage patterns. Each UDF within this directory will be automatically synchronized to the bqutil project within the fn dataset for reference in queries.</p></blockquote><p>å®Ÿéš›ã«ä»¥ä¸‹ã®ã‚¯ã‚¨ãƒªã‚’ Google BigQuery ã§å®Ÿè¡Œã™ã‚‹ã¨</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-sql data-lang=sql><span class=k>SELECT</span>
  <span class=n>bqutil</span><span class=p>.</span><span class=n>fn</span><span class=p>.</span><span class=n>typeof</span><span class=p>(</span><span class=s2>&#34;&#34;</span><span class=p>),</span>
  <span class=n>bqutil</span><span class=p>.</span><span class=n>fn</span><span class=p>.</span><span class=n>typeof</span><span class=p>(</span><span class=n>b</span><span class=s2>&#34;&#34;</span><span class=p>),</span>
  <span class=n>bqutil</span><span class=p>.</span><span class=n>fn</span><span class=p>.</span><span class=n>typeof</span><span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=p>),</span>
  <span class=n>bqutil</span><span class=p>.</span><span class=n>fn</span><span class=p>.</span><span class=n>typeof</span><span class=p>(</span><span class=n>STRUCT</span><span class=p>()),</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>STRING
BYTES
FLOAT64
STRUCT
</code></pre></td></tr></table></div></div><p>ã®çµæœãŒå‡ºåŠ›ã•ã‚Œã€å„ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã®å‹ã‚’ç¢ºèªã§ãã‚‹ã€‚</p><p><img loading=lazy src=/posts/2022-01-20/images/1.png alt=result></p><p>ä¾¿åˆ©!</p><p>ã“ã‚Œã§ç½®ãæ›ãˆå¯èƒ½ãª UDF ã¯ç½®ãæ›ãˆã‚Œã°ãƒ¡ãƒ³ãƒ†ãƒ³ã‚¹ã—ãªã„ã¨ã„ã‘ãªã„ UDF ãŒå‰Šæ¸›ã•ã‚Œã¦å¬‰ã—ã„ã§ã™ã­</p><p><code>bqutil.fn.typeof()</code> ã® UDF ã®å®Ÿæ…‹ã¨ã—ã¦ã¯
<a href=https://github.com/GoogleCloudPlatform/bigquery-utils/blob/master/udfs/community/typeof.sqlx>bigquery-utils/udfs/community/typeof.sqlx</a>ãŒå‚ç…§ã•ã‚Œã¦å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã€‚</p><p>ä»–ã«ã‚‚</p><ul><li>URL ã® key ã‚’æŠ½å‡ºã§ãã‚‹<a href=https://github.com/GoogleCloudPlatform/bigquery-utils/tree/master/udfs/community#url_keysquery-string>bqutil.fn.url_keys()</a></li><li>ãƒ©ãƒ³ãƒ€ãƒ ãªå€¤ã‚’å‡ºåŠ›ã§ãã‚‹<a href=https://github.com/GoogleCloudPlatform/bigquery-utils/tree/master/udfs/community#random_valuearr-any-type>bqutil.fn.url_keys()</a></li></ul><p>ãªã©ã€è‡ªå‰ã§æ­£è¦è¡¨ç¾ã§é ‘å¼µã£ã¦æ›¸ã„ã¦ã„ã‚‹ã‘ã©å®Ÿéš›ã¯ OSS ã® UDF ã¨ã—ã¦å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚å¤šã€…ã‚ã‚Šãã†ãªã‹ã‚†ã„ã¨ã“ã‚ã«æ‰‹ãŒå±Šã UDF ãŒå¤šæ•°å…¬é–‹ã•ã‚Œã¦ã„ãŸã€‚</p><p>å¤‰ã‚ã‚Šç¨®ã¨ã—ã¦ã¯ã€
<a href=https://github.com/GoogleCloudPlatform/bigquery-utils/tree/master/udfs/community#statslib-statistical-udfs>StatsLib: Statistical UDFs</a>ã¨ã„ã†çµ±è¨ˆçš„ãªå‡¦ç†ã‚’è¡Œã† UDF ã‚‚å…¬é–‹ã•ã‚Œã¦ã„ãŸã€‚</p><p>ç·šå½¢å›å¸°ã‚„ p å€¤ã®è¨ˆç®—ãŒã§ãã‚‹ UDF ã‚‚å…¬é–‹ã•ã‚Œã¦ãŠã‚Šã€é¢ç™½ã„</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://stackoverflow.com/questions/43730045/bigquery-type-check-operator-like-typeof-in-javascript-or-workaround>bigquery type check operator? like typeof in Javascript; or workaround</a></li><li><a href=https://github.com/GoogleCloudPlatform/bigquery-utils/tree/master/udfs/community#typeofinput-any-type>typeof(input ANY TYPE)</a></li></ul><h2>See Also</h2><ul><li><a href=/posts/2019-10-03/>é…ã™ãã‚‹ `pandas.read_gbq` ã‚’ä½¿ã‚ãšã«ã€Google BigQueryã‹ã‚‰é«˜é€Ÿã«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€</a></li><li><a href=/posts/2021-11-06/>Standard SQLã®COALESCEã§ã€æ™‚é–“çµŒéã«ã‚ˆã£ã¦ã‚«ãƒ©ãƒ åãŒå¤‰åŒ–ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’æŸ”è»Ÿã«æŠ½å‡ºã™ã‚‹</a></li><li><a href=/posts/2021-11-05/>Google Cloud Pub/Sub ã«å…¬é–‹ã•ã‚ŒãŸçµæœã¯Dataflow template ã‚’ä½¿ãˆã°ã‚ã¡ã‚ƒãã¡ã‚ƒç°¡å˜ã«ç¢ºèªã§ãã‚‹</a></li><li><a href=/posts/2021-10-04/>CloudComposer ã®DAGã‚’CircleCIã§æ›´æ–°ã™ã‚‹</a></li><li><a href=/posts/2021-09-29/>GCPã®Cloud Composer ã®DAGã‚’ç´ æ—©ããƒ»ç°¡å˜ã«ãƒ‡ãƒãƒƒã‚°ã™ã‚‹</a></li></ul><h2>Support</h2>è¨˜äº‹ã‚’ãŠèª­ã¿ãã ã•ã‚Šã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã“ã®ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã®é‹å–¶ã‚’æ”¯æ´ã—ã¦ã„ãŸã ã‘ã‚‹æ–¹ã‚’å‹Ÿé›†ã—ã¦ã„ã¾ã™ã€‚
ã‚‚ã—ã‚ˆã‚ã—ã‘ã‚Œã°ã€ä¸‹ã®ãƒœã‚¿ãƒ³ã‹ã‚‰ã‚µãƒãƒ¼ãƒˆ(æŠ•ã’éŠ­)ã—ã¦ã„ãŸã ã‘ã‚‹ã¨ã€ãƒ–ãƒ­ã‚°åŸ·ç­†ã€æƒ…å ±ç™ºä¿¡ã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã«ç¹‹ãŒã‚Šã¾ã™âœ¨
<a href=https://www.buymeacoffee.com/hurutoriya><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=â˜•&slug=hurutoriya&button_colour=FFDD00&font_colour=000000&font_family=Inter&outline_colour=000000&coffee_colour=ffffff"></a></div><footer class=post-footer><ul class=post-tags><li><a href=https://shunyaueta.com/tags/bigquery/>bigquery</a></li><li><a href=https://shunyaueta.com/tags/gcp/>gcp</a></li></ul><nav class=paginav><a class=prev href=https://shunyaueta.com/posts/2022-01-21/><span class=title>Â« å‰ã®ãƒšãƒ¼ã‚¸</span><br><span>Search Engineering Newsletter vol.01</span></a>
<a class=next href=https://shunyaueta.com/posts/2022-01-19/><span class=title>æ¬¡ã®ãƒšãƒ¼ã‚¸ Â»</span><br><span>GitHub discussion ã‚’ä½¿ã£ãŸã‚³ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ  giscus ã‚’å°å…¥</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=hurutoriya/hurutoriya.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk2MDgyNTY1Nw==" data-category=Comments data-category-id=DIC_kwDOA6AgOc4CAQTX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=dark data-lang=ja crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2022 <a href=https://shunyaueta.com/>ğŸ¦… hurutoriya</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z" /></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerText='copy';function copyingDone(){copybutton.innerText='copied!';setTimeout(()=>{copybutton.innerText='copy';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>