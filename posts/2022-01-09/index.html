<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>OSSのアノテーションツール Label Studio を使って、快適にアノテーションする | Shunya Ueta</title><link rel=stylesheet href=/sass/main.min.b81b77bfef641cdef5a77f4a7bb221547def6cea9b73ab29b5fed4c98707f2a8.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-39994406-11','auto');ga('send','pageview');}</script><meta property="og:title" content="OSSのアノテーションツール Label Studio を使って、快適にアノテーションする"><meta property="og:description" content="Google Spread Sheet による即席アノテーションの限界 データ分析で、ラベルがないデータに対して、自分でアノテーション(ラベルを付与)してデータの傾向を素早く掴みたい時がある。 例えば、文章に対してネガティブ・ポジティブなクラスを割り振ったり、画像に対して人が写り込んでいるか否かなどの簡単な分類タスクでは、お手軽に Google Spread Sheet などを使って、500 件のアノテーションはそこまで問題がなく気合でやれる。
実際の流れとしては、GCP を採用している場合、Google BigQuery から SQL でデータを抽出してそのまま Google Sprad Sheet に出力、=image()関数で CDN から画像の URL を参照できたりなどなどかなり便利。 Spread Sheet を共有して複数人でも作業ができるのも魅力的。
だが、文章の特定の部分を選択してタグを付けたかったり、クラス数が二桁など少し複雑なアノテーションタスクを行いたい場合 Google Spread Sheet では、アノテーションの生産性が劇的に落ちる、もしくは不可能になる。あくまで Google Spread Sheet はお手軽にラベリングを行うだけで、ラベリング専用ツールではないので当然の帰着ではある&mldr;
Label Studio とは 今回紹介するLabel Studioは OSS データのラベリング(アノテーション)ツールは、
 画像  画像分類 物体認識 セマンティックセグメンテーション   音声  音声分類 話者分類 感情認識 文字起こし   文章  文書分類 固有表現抽出(NER) 質疑応答 感情分析   時系列データ  時系列分類 時系列分割 イベント認識   マルチモーダル  対話処理 文字認識(OCR) ビデオ・音声の時系列分類    など多種多様なドメインに対してラベリングを行うことができるソフトウェアだ。"><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2022-01-09/"><meta property="og:image" content="https://shunyaueta.com/ogp.jpg"><meta property="article:published_time" content="2022-01-09T23:05:16+09:00"><meta property="article:modified_time" content="2022-01-10T22:02:52+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/ogp.jpg"><meta name=twitter:title content="OSSのアノテーションツール Label Studio を使って、快適にアノテーションする"><meta name=twitter:description content="Google Spread Sheet による即席アノテーションの限界 データ分析で、ラベルがないデータに対して、自分でアノテーション(ラベルを付与)してデータの傾向を素早く掴みたい時がある。 例えば、文章に対してネガティブ・ポジティブなクラスを割り振ったり、画像に対して人が写り込んでいるか否かなどの簡単な分類タスクでは、お手軽に Google Spread Sheet などを使って、500 件のアノテーションはそこまで問題がなく気合でやれる。
実際の流れとしては、GCP を採用している場合、Google BigQuery から SQL でデータを抽出してそのまま Google Sprad Sheet に出力、=image()関数で CDN から画像の URL を参照できたりなどなどかなり便利。 Spread Sheet を共有して複数人でも作業ができるのも魅力的。
だが、文章の特定の部分を選択してタグを付けたかったり、クラス数が二桁など少し複雑なアノテーションタスクを行いたい場合 Google Spread Sheet では、アノテーションの生産性が劇的に落ちる、もしくは不可能になる。あくまで Google Spread Sheet はお手軽にラベリングを行うだけで、ラベリング専用ツールではないので当然の帰着ではある&mldr;
Label Studio とは 今回紹介するLabel Studioは OSS データのラベリング(アノテーション)ツールは、
 画像  画像分類 物体認識 セマンティックセグメンテーション   音声  音声分類 話者分類 感情認識 文字起こし   文章  文書分類 固有表現抽出(NER) 質疑応答 感情分析   時系列データ  時系列分類 時系列分割 イベント認識   マルチモーダル  対話処理 文字認識(OCR) ビデオ・音声の時系列分類    など多種多様なドメインに対してラベリングを行うことができるソフトウェアだ。"></head><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/><span class=emoji>🦅</span>
Shunya Ueta</a></div><div class=flex><a href=/articles/>All posts</a>
<button id=dark-mode-button></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>OSSのアノテーションツール Label Studio を使って、快適にアノテーションする</h1><div class=post-meta><div>By Shunya Ueta on <time>2022.01.09</time> (Last updated:<time>2022.01.10</time>)</div><div class=tags><a href=/tags/annotation/>annotation</a>
<a href=/tags/machinelearning/>machinelearning</a></div></div></div></div></header></article><div class=article-post><h2 id=google-spread-sheet-による即席アノテーションの限界>Google Spread Sheet による即席アノテーションの限界</h2><p>データ分析で、ラベルがないデータに対して、自分でアノテーション(ラベルを付与)してデータの傾向を素早く掴みたい時がある。
例えば、文章に対してネガティブ・ポジティブなクラスを割り振ったり、画像に対して人が写り込んでいるか否かなどの簡単な分類タスクでは、お手軽に Google Spread Sheet などを使って、500 件のアノテーションはそこまで問題がなく気合でやれる。</p><p>実際の流れとしては、GCP を採用している場合、Google BigQuery から SQL でデータを抽出してそのまま Google Sprad Sheet に出力、<code>=image()</code>関数で CDN から画像の URL を参照できたりなどなどかなり便利。
Spread Sheet を共有して複数人でも作業ができるのも魅力的。</p><p>だが、文章の特定の部分を選択してタグを付けたかったり、クラス数が二桁など少し複雑なアノテーションタスクを行いたい場合 Google Spread Sheet では、アノテーションの生産性が劇的に落ちる、もしくは不可能になる。あくまで Google Spread Sheet はお手軽にラベリングを行うだけで、ラベリング専用ツールではないので当然の帰着ではある&mldr;</p><h2 id=label-studio-とは>Label Studio とは</h2><p>今回紹介する<a href=https://labelstud.io/>Label Studio</a>は OSS データのラベリング(アノテーション)ツールは、</p><ul><li>画像<ul><li>画像分類</li><li>物体認識</li><li>セマンティックセグメンテーション</li></ul></li><li>音声<ul><li>音声分類</li><li>話者分類</li><li>感情認識</li><li>文字起こし</li></ul></li><li>文章<ul><li>文書分類</li><li>固有表現抽出(NER)</li><li>質疑応答</li><li>感情分析</li></ul></li><li>時系列データ<ul><li>時系列分類</li><li>時系列分割</li><li>イベント認識</li></ul></li><li>マルチモーダル<ul><li>対話処理</li><li>文字認識(OCR)</li><li>ビデオ・音声の時系列分類</li></ul></li></ul><p>など多種多様なドメインに対してラベリングを行うことができるソフトウェアだ。</p><p>また、アカウント認証や、キーボードショートカットなどアノテーションの生産性を向上させる基本的な機能が標準で搭載されており、アノテーション効率の向上と管理が期待できる。</p><p>同様に OSS の自然言語タスクに特化したアノテーションツールの<a href=https://github.com/doccano/doccano>doccano</a> も検討したが、Label Studio は自然言語以外にも画像やランキングなど多種多様なラベリングタスクに対応しているので、後々にアノテーションしたいデータの種類が増えたとしても Label Studio を活用できて便利そうなので、今回は Label Studio を選択した。</p><p>機能として</p><ul><li>アノテーションのインターフェイスは xml のような形式で、GUI で柔軟に作成可能。画像・文章を組み合わせて表示したいときでも容易に表現が可能。</li><li>Web アプリとして完結していて、よほど込み入ったことをしたいと思わない限り、Docker か pip でインストールしてコマンド実行するだけで良い。データを準備するだけで、コードを書かなくてよい</li><li>実行環境として Cloud Run で実行可能、pip でインストールして実行するだけでも起動可能なのでポータビリティが高い。</li></ul><p>が気に入った。</p><p>また、今は使わないが</p><ul><li>機械学習モデルを組み込んで、アノテーションの補助が可能な点</li><li>AWS, GCP, Azure の CloudStorage と連携が可能</li><li>Webhook で連動させて、アノテーションが完了したらジョブを実行</li></ul><p>が気になっている。</p><h2 id=label-studio-の活用方法>Label Studio の活用方法</h2><p>以下の画像の URL が格納されている <code>onepiece.csv</code>を使って、各画像に指定のクラスを割り振るデータラベリングを Label Studio を使って実行する。</p><pre><code class=language-csv data-lang=csv>image
https://1.bp.blogspot.com/-uxIsaN0S5lQ/X-FcrvAAInI/AAAAAAABdD4/6uw_qNUh9dQrG0aUzIExybt84yTEmXOPwCNcBGAsYHQ/s200/onepiece01_luffy.png
https://1.bp.blogspot.com/-rzRcgoXDqEg/YAOTCKoCpPI/AAAAAAABdOI/5Bl3_zhOxm07TUGzW8_83cXMOT9yy1VJwCNcBGAsYHQ/s200/onepiece02_zoro_bandana.png
https://1.bp.blogspot.com/-2ut_UQv3iss/X-Fcs_0oAII/AAAAAAABdD8/jrCZTd_xK-Y6CP1KwOtT_LpEpjp-1nvxgCNcBGAsYHQ/s200/onepiece03_nami.png
https://1.bp.blogspot.com/-mZpzgXC1Sxk/YAOTCAKwWTI/AAAAAAABdOM/5B4hXli0KLU5N-BySHgjVbhZscKLSE-bQCNcBGAsYHQ/s200/onepiece04_usopp_sogeking.png`
</code></pre><p>例とする画像の URL は<a href=https://www.irasutoya.com/>いらすとや</a>さんを参照させていただいております。</p><p>今回はお手軽に Poetry で Label Studio をインストールして、ローカル環境で実行した。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell><span class=c1># Requires &gt;=Python3.6, &lt;3.9</span>
poetry add label-studio

<span class=c1># Start the server at http://localhost:8080</span>
poetry run label-studio
</code></pre></td></tr></table></div></div><h2 id=実際の作業の撮影動画>実際の作業の撮影動画</h2><ol><li>Label Studio の起動</li><li>プロジェクトの作成</li><li>データのアップロード</li><li>アノテーションの実行</li><li>アノテーション結果のダウンロード</li></ol><p>までの動画を撮影した。</p><p>動画で見ることで、Label Studio の魅力がわかるのではなかろうか。
キーボードショートカットが搭載されていて、実際のアノテーション作業がとても快適に行える点がわかるのではなかろうか。</p><iframe width=560 height=315 src=https://www.youtube.com/embed/lIuREkAdDa0 title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>以下に、実際の画面ごとの解説をしておく。</p><h2 id=プロジェクトの作成>プロジェクトの作成</h2><p><img src=/posts/2022-01-09/images/1.png alt></p><p><code>poetry run label-studio</code> で Lebel Studio を起動後、右上の Create ボタンからプロジェクトを作成する。プロジェクト = 必要なアノテーションデータの 1 単位と考えれば良い。
上の 3 つのタブ</p><ul><li>Project Name : プロジェクトの概要を入力</li><li>Data Import : アノテーション対象のデータをアップロード</li><li>Labeling Setup : ラベリング方式の設定</li></ul><h2 id=アノテーションテンプレート選択>アノテーションテンプレート選択</h2><p><img src=/posts/2022-01-09/images/2.png alt></p><p>Labeling Setup では、様々なドメインのアノテーションタスクをテンプレートから選択が可能</p><h2 id=ラベリングインターフェイス>ラベリングインターフェイス</h2><p><img src=/posts/2022-01-09/images/3.png alt></p><p>テンプレートを選択後、GUI でタグを自分で選択して編集する。
Code タグを選択すれば、直接インターフェイスを xml ライクに宣言ができる。
各種タグは</p><p><a href=https://labelstud.io/tags/>https://labelstud.io/tags/</a></p><p>を参考にすれば、柔軟にアノテーションが組める。Web アプリ上で完結しつつ柔軟にインターフェイスを構築できるのは感動した。</p><h4 id=タグの豆知識>タグの豆知識</h4><p><code>&lt;Header></code> タグで、各種データの説明文を設定可能</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;Header</span> <span class=na>value=</span><span class=s>&#34;説明文&#34;</span><span class=nt>/&gt;</span>
</code></pre></td></tr></table></div></div><p>タグの末尾に <code>/</code> を入れることで閉じタグを省略できる。
以下の 2 つは等価</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;Header</span> <span class=na>value=</span><span class=s>&#34;$title&#34;</span><span class=nt>/&gt;</span>
<span class=nt>&lt;Header</span> <span class=na>value=</span><span class=s>&#34;$title&#34;</span><span class=nt>&gt;&lt;/Header&gt;</span>
</code></pre></td></tr></table></div></div><p><code>&lt;TextArea></code> タグを使えば、判断に困った際のデータに対してコメントを残せる
<code>toName</code> 要素で、何に対するコメントなのかを指定する。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml><span class=nt>&lt;TextArea</span> <span class=na>name=</span><span class=s>&#34;comment&#34;</span> <span class=na>toName=</span><span class=s>&#34;text&#34;</span> <span class=na>placeholder=</span><span class=s>&#34;Enter Comment here...&#34;</span> <span class=na>maxSubmissions=</span><span class=s>&#34;1&#34;</span> <span class=na>rows=</span><span class=s>&#34;3&#34;</span> <span class=na>editable=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</code></pre></td></tr></table></div></div><h2 id=プロジェクト画面>プロジェクト画面</h2><p><img src=/posts/2022-01-09/images/4.png alt></p><p>プロジェクト画面では、アップロードされたデータやアノテーションの進捗具合などがひと目で把握できる。
データセットに画像の URL があれば、カラムの属性を<code>img</code>に変更すれば一覧画面でその画像が表示される。</p><h2 id=アノテーション画面>アノテーション画面</h2><p><img src=/posts/2022-01-09/images/5.png alt></p><p>Mac だと Command + Enter で Submit, 例だと、例えばナミはキーボードで 3 を押せば選択される。これらのキーボードショートカット機能により高速にアノテーションが可能。</p><p>もう少し使い込んだら、また続編を書きたい。
OSS でこのクオリティのアノテーションソフトウェアが公開されるようになっているのは本当に素晴らしい。</p></div><h2>Support</h2><div class=container><div class=posts><div class=post><div class=post-row><a href=https://www.buymeacoffee.com/hurutoriya target=_blank>☕️ Buy me a cofee: お読みくださりありがとうございます。
こちらから ☕ を一杯支援していただけると、ブログ執筆のモチベーションに繋がります ✨</a></div></div></div></div><h2>See Also</h2><ul><li><a href=/posts/2021-12-26/>[抄訳] Daria Sorokina さんによる、 Amazon 検索での製品のランキング付けの楽しさ at MLconf SF 2016</a></li><li><a href=/posts/2021-10-09/>クエリ分類(Query Classification) について社内の勉強会で話してきた</a></li><li><a href=/posts/2021-05-29/>2021年05月時点で自分が実践しているMLOpsの情報収集方法</a></li><li><a href=/posts/2021-01-17/>[抄訳] Towards ML Engineering: A Brief History Of TensorFlow Extended (TFX)</a></li><li><a href=/posts/2020-09-21/>自分なりの機械学習エンジニアスキル構成論</a></li></ul></div><div class=container><nav class="flex container suggested"><a rel=prev href=/posts/2022-01-07/ title="Previous post (older)"><span>Previous</span>
2021 年良かったもの</a></nav></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links><a href=/about/>About</a>
<a href=/index.xml>RSS</a>
<a href=https://www.buymeacoffee.com/hurutoriya>Support</a></nav></section><script async src=/js/features.min.a94f58a30ad2560de728e080d87f75c60cf806fd1b3d5f4815f1a1a02c0d1859.js></script></footer></body></html>