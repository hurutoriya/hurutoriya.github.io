<!doctype html><html><head><script data-ad-client=ca-pub-8604812913439531 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Shunya Ueta (a.k.a hurutoriya) personal website"><link rel="shortcut icon" href=https://shunyaueta.com/favicon.ico><link rel=stylesheet href=/css/style.min.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-39994406-11"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-39994406-11');</script><title>GitHub codeowners でGithubグループを指定しても反映されない時の対処方法</title></head><body><header id=banner><h2><a href=https://shunyaueta.com/>Software Engineer as Data Scientist</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/about/ title=about>about</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>GitHub codeowners でGithubグループを指定しても反映されない時の対処方法</h1><time>2020-09-19</time></header><p>GitHub の <a href=https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/about-code-owners>CODEOWNERS</a> という機能を使えば、レポジトリに対するPRでは設定された CODEOWNER がAPPROVEを出さないとマージされないようにできます。</p><p>この機能を使うことで、例えばそのリポジトリのオーナーであるグループが必ずPRを確認しないとマージできないようにすることでコードのクオリティを保つ仕組みが作れます。</p><h2 id=tldr>TL;DR</h2><ul><li>GitHub codeowners で特定のグループをCODEOWNERSに設定したいときは、そのグループをレポジトリの <code>/settings/access</code>で <code>Maintain</code> として追加しないとGitHub PR で自動的にreviwer に追加されない</li><li>リポジトリで<code>.github/CODEOWNERS</code> のファイルを作成して、以下の形式でGitHub group を追加する</li></ul><div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>* @octo-org/codeowners-team
</code></pre></div><ul><li>リポジトリの設定の<code>/settings/access</code>にアクセスして、<code>@octo-org/codeowners-team</code> を <code>Maintain</code> として追加する。</li></ul><p>*試していないのですが、<code>Write</code> や <code>Triage</code> 権限でも問題ないかもしれません。</p><p><img src=/posts/2020-09-19/images/1.png alt="repository access setting"></p><p>この設定をしたあとに、GitHub PRを新たに作成すると、自動的に CODEOWNERS のapproveがないとマージされないように設定されるはずです。</p><h3 id=自分自身がハマった経緯>自分自身がハマった経緯</h3><p>グループ全体のアカウントが追加されている<code>a-group/all</code>というGithub Groupがすでにリポジトリのアクセス権限に <code>Write</code> 権限として追加されており、全員がwrite権限をもっているならcodeownersとしての権限も問題ないだろうと思っていたらハマりました。</p><p>CODEOWNERS の仕組みを知ると理解できるのですが、<code>a-group/all</code> が指定したいグループの包含関係にあるからといって、そのように取り扱ってくれるわけではないということですね。</p></article></main><footer id=footer>Copyright © 2013-2021 Shunya Ueta</footer></body></html>