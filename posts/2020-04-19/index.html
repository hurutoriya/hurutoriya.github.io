<!doctype html><html lang=ja dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」 | hurutoriya</title><meta name=keywords content="machinelearning,paper,translation,mlops"><meta name=description content="NIPS206 にて開催された Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016) という、現実世界でどうやって信頼性の高い機械学習に取り組んでいくかについてのワークショップがある。
ここで Google から発表された What’s your ML test score? A rubric for ML production systems がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。
 PDF Slide 発表動画もワークショップページにて公開されています。  change logs  2021-04-25  この原著論文の完全版になっている論文の抄訳を新たに公開しています。 [抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction     概略  現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠 しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか? この論文では、それらの問題を解決する ML Test Score という基準を提案する  Introduciton   Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案"><meta name=author content="Shunya Ueta"><link rel=canonical href=https://shunyaueta.com/posts/2020-04-19/><link crossorigin=anonymous href=/assets/css/stylesheet.abc7c82c3d415a6df50430738d1cbcc4c76fea558bc5a0c830d3babf78167a35.css integrity="sha256-q8fILD1BWm31BDBzjRy8xMdv6lWLxaDIMNO6v3gWejU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://shunyaueta.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shunyaueta.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shunyaueta.com/favicon-32x32.png><link rel=apple-touch-icon href=https://shunyaueta.com/apple-touch-icon.png><link rel=mask-icon href=https://shunyaueta.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-JMJRQJT0Q3"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-JMJRQJT0Q3');</script><meta property="og:title" content="機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」"><meta property="og:description" content="NIPS206 にて開催された Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016) という、現実世界でどうやって信頼性の高い機械学習に取り組んでいくかについてのワークショップがある。
ここで Google から発表された What’s your ML test score? A rubric for ML production systems がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。
 PDF Slide 発表動画もワークショップページにて公開されています。  change logs  2021-04-25  この原著論文の完全版になっている論文の抄訳を新たに公開しています。 [抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction     概略  現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠 しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか? この論文では、それらの問題を解決する ML Test Score という基準を提案する  Introduciton   Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案"><meta property="og:type" content="article"><meta property="og:url" content="https://shunyaueta.com/posts/2020-04-19/"><meta property="og:image" content="https://shunyaueta.com/ogp.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-19T22:18:10+09:00"><meta property="article:modified_time" content="2020-04-19T22:18:10+09:00"><meta property="og:site_name" content="Shunya Ueta"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://shunyaueta.com/ogp.jpg"><meta name=twitter:title content="機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」"><meta name=twitter:description content="NIPS206 にて開催された Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016) という、現実世界でどうやって信頼性の高い機械学習に取り組んでいくかについてのワークショップがある。
ここで Google から発表された What’s your ML test score? A rubric for ML production systems がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。
 PDF Slide 発表動画もワークショップページにて公開されています。  change logs  2021-04-25  この原著論文の完全版になっている論文の抄訳を新たに公開しています。 [抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction     概略  現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠 しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか? この論文では、それらの問題を解決する ML Test Score という基準を提案する  Introduciton   Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」","item":"https://shunyaueta.com/posts/2020-04-19/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」","name":"機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」","description":"NIPS206 にて開催された Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016) という、現実世界でどうやって信頼性の高い機械学習に取り組んでいくかについてのワークショップがある。\nここで Google から発表された What’s your ML test score? A rubric for ML production systems がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。\n PDF Slide 発表動画もワークショップページにて公開されています。  change logs  2021-04-25  この原著論文の完全版になっている論文の抄訳を新たに公開しています。 [抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction     概略  現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠 しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか? この論文では、それらの問題を解決する ML Test Score という基準を提案する  Introduciton   Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案","keywords":["machinelearning","paper","translation","mlops"],"articleBody":"NIPS206 にて開催された Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016) という、現実世界でどうやって信頼性の高い機械学習に取り組んでいくかについてのワークショップがある。\nここで Google から発表された What’s your ML test score? A rubric for ML production systems がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。\n PDF Slide 発表動画もワークショップページにて公開されています。  change logs  2021-04-25  この原著論文の完全版になっている論文の抄訳を新たに公開しています。 [抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction     概略  現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠 しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか? この論文では、それらの問題を解決する ML Test Score という基準を提案する  Introduciton   Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案\n  このスコアは、機械学習を始めたばかるのチームからエキスパートがあつまるチームまで幅広く適用可能\n  注意: 一般的な Sofware Engineering のベストプラクティスは含んでいない\n  そのかわり、学習とサービングのための Unit Test Coverage の計算方法など機械学習に必要不可欠な点を抑えている\n  ML Test Score の計算方法  各テストの加点基準  1pt: 手動で実行し、その結果を文章として共有済 2pt: CI に組み込まれ、自動的に反復実行済   最終的な ML Score は以下の基準となる  0pt : プロダクション向けというよりも研究プロジェクト 1-2pt : テストが少しはされているが、プロダクションではもっと深刻な罠がある可能性あり 3-4pt : 最初のプロダクションレディへの第一歩。しかし、さらなる投資が必要 5-6pt : 適切なテストがされているが、もっと自動化してみよう 7-10pt : 自動化されたテストとモニタリングが整備されている。重要なシステムでも適切なレベルに達している 12+pt : 卓越した自動化されたテストとモニタリング    前提条件  システムアーキテクチャの前提として、生データから特徴量を抽出し、学習システムに流し込まれる。そして推論のためにサービングされ、その機能は顧客に影響を与える。また、ソースリポジトリや CI を通したテスト、実験のバージョン管理なども可能  特徴量とデータセット  各特徴量の分布が期待した値になっているか?  一例として、特徴 A が 1 から５の値を持つ、または特徴 B の最も普遍期な値として「Harry」と「Potter」が全体の 10%を占める特徴に対して、上記の分布を検証するようなテストを書き、このテストが失敗すれば外部環境が変化しモデルの変更が余儀なくされていることが把握できる   各特徴と目的変数の関係性そして、ペアの相関が独立してあらわれるか?  個の特徴がモデルに使用される際に、   各特徴量のコストは検討されているか?  特徴量のコストとは、各特徴を追加した際の推論速度やメモリ使用率、データ依存 \u0008 やその特徴に依存することによるシステムの不安定性などの検証   手動作業により適切でない特徴量は使用されていないか? データパイプラインの中で、プライバシーコントロールが考慮されているか?  Access Controll の権限は機械学習システムにも適切に付与されているか検証を行う   プロダクションモデルへ新しい特徴量を開発・追加するのに必要な日数はいくらか?  ちょっとしたアイデアをプロダクションで素早く検証できるチームは強い。速さはシステムの改善と外的変化の対応するために重要   学習とサービングで使用される特徴量生成に関わるコードすべてに対するテスト  軽視されがちだが、非常に重要    モデル開発  全てのモデルはコードレビューされリポジトリに格納されているか?  コードレビューは素晴らしい仕組みで、つまらないミスやインシデントに関わるような潜在的なものまで顕在化される   オフラインの疑似指標とオンライン指標の関係性  1%の精度がお客さまの満足度にどうつながるのだろうか? (例: CTR) この検証は意図的に劣化させたモデルなどで小規模の AB テストを通して検証可能   チューニング可能な各ハイパーパラメータのインパクト  グリッドサーチやベイズ最適化は、予測性能を向上させるだけではなく潜在的な信頼性の問題を明らかにできる。例えば、データ並列によるモデルの精度の変化は大きなインパクトである   モデルのフレッシュネス  各モデルが、昨日 VS 先週 VS 過去一年 で学習されたとしてオンラインメトリクスへの影響がどう異なるか? 全てのモデルは外部要求により更新を余儀なくされる。この評価は注意深く行い、決定していくこと   単純なモデルをベースラインとした検証  線形モデルで少ない特徴量のモデルでベースラインを作成しよう。これは、大規模なパイプライン構築やコストのトレードオフの検証にとても効果的である   重要なデータを分割した際のモデル品質の検証  TBD: ちょっと理解しきれない   暗黙的バイアスへの検証  例えば学習データの規模が小規模だと暗黙的なバイアスが掛かってしまう。(例：靴の認識で、男物の靴しか学習データが収集できず、女性の靴のデータがほぼ存在しないなど)    機械学習インフラストラクチャ  モデルの学習の再現性検証  完全に同一データから、２つのモデル作成する。両者のスコア、サンプルに対する予測結果など大きな違いがないか検証を行う   モデルの仕様に関する検証  有用な Assertion として、ロスの低下や学習ジョブがクラッシュしても復元可能など   完全な機械学習パイプラインテストのための結合テスト  良い結合テストとは、もとのデータソースから特徴生成 → 学習 またはサービングまでをカバーする。結合テストは CI を通じて実行し、潜在的な問題をリリース前に発見するために新規リリースの前に検証される   サービング前のモデル品質テスト  サンプルデータを収集して、既知の正しい出力がされるように検証を行い、集計する。\u0008 前バージョンの機械学習モデルの予測結果を用いたバックテストも良い取り組みの一つ   一つのサンプル、もしくはバッチ学習をモデルに送り、学習から予測までの内部状態の変化の監視  少量のデータを流し、モデルの状態がどう変化するか監視するのは有効なアプローチである   本番環境前のカナリアリリースによるテスト  モデリングのコードはサービングコードと違って高頻度に変化する。それにより以前のサービングコードが新しいモデルでは動かない危険性なども発生する。この検証は、モデルがプロダクション環境下で正常に読み込まれるか、正常に推論が稼働するかを確認する。新しいモデルは常に、小規模のトラフィックで検証されるべきである   新しい機械学習モデルから、安全かつ素早く前の機械学習モデルに戻せるか?  モデルのローロバック手続きは、モデルの品質がリリースして良くなかった場合にとても便利である。以前の高性能なモデルに安全かつ素早く戻せる仕組みは非常に重要    機械学習のためのモニタリング指標  学習とサービングの両者にて、イベント発生時の不安定性の検証  モデルの学習時間の不安定性  モデルが頻繁に再学習されるような状況だと、特に問題である   サービング時間の不安定性  client 側の通信が停止したりすると、サービングされなくなる     学習時とサービング時でデータの不変性が保持されているかの検証  例: 特徴量 A と B は、常に同一の非零の要素数を持つ、特徴量 C は常に(0,100)の範囲内かなどを検証する   学習したモデルと、サービングの特徴が完全に同一か  Training/ Serviing Skew とも呼ばれている (Concept Drift とも呼ばれています) 学習したデータと本番のデータが時間経過、もしくは何らかの要因で異なってしまうことが原因です Training/Serving skew は TFX で説明されている   モデルは枯れているか?  使い古されたモデルの場合、パイプラインが停止しても何が原因か把握できる。例えば、重要なテーブルを作成する毎日実行されるジョブがストップしたとして、どんなアラートが良いだろうか? *TBD   学習、もしくはサービング時にNaN または、 無限の値が発生への検証 学習速度、サービング速度、スループットまたは RAM 使用率の検証  スケールする際に機械学習システムの計算機コストは悩みの種である。回帰テストなどで検証されるべきである   予測品質に関する回帰テスト  外部要因により、品質が下がる場合もあるが多くの場合は現実の問題を洗い出すことができる     翻訳でもし怪しい部分やもっとこうしたほうが良いというところがあれば、コメントか @hurutoriya までご連絡ください\n実際読み込んで見ると、信頼性の高いモデルを届けるための秘訣が山盛りで、流石 Google 内のベストプラクティスをまとめたチェックリストですね 実際に開発している機械学習システムがあれば、この Test Score を当てはめてみてどの程度できているのか計測してみるが良さそう\n機械学習エンジニアとして働く自分として、興味のど真ん中にあるようなワークショップだが、2016,2017 年の二回しか開催されておらず、非常に悲しい 逆に言えば、すごく先進的なワークショップでこのワークショップが開催されていたのは凄いことだ\n自分が業務を通じて得た経験やベストプラクティスがすでに論文として世の中に公開されているのはすごく経験になるし、経験から学ぶのではなく歴史から学べるようにしていきたい！ なので、この Workshop 論文の発展形として、The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction が発表されているので読んでみる\nいや、実装寄りの勉強ばかりしていたけど気分転換にこういう知識体系に触れるのすごく楽しい\n","wordCount":"259","inLanguage":"ja","datePublished":"2020-04-19T22:18:10+09:00","dateModified":"2020-04-19T22:18:10+09:00","author":{"@type":"Person","name":"Shunya Ueta"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shunyaueta.com/posts/2020-04-19/"},"publisher":{"@type":"Organization","name":"hurutoriya","logo":{"@type":"ImageObject","url":"https://shunyaueta.com/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://shunyaueta.com/ accesskey=h title="hurutoriya (Alt + H)">hurutoriya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://shunyaueta.com/archives title=Archive><span>Archive</span></a></li><li><a href=https://shunyaueta.com/about title=About><span>About</span></a></li><li><a href=https://searchengineeringnewsletter.substack.com/ title=Newsletter><span>Newsletter</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://shunyaueta.com/index.xml title=RSS><span>RSS</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>機械学習システムの信頼性を数値化する論文「 What’s your ML test score? A rubric for ML production systems」</h1><div class=post-meta><span title="2020-04-19 22:18:10 +0900 +0900">April 19, 2020</span>&nbsp;·&nbsp;Shunya Ueta</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>目次</span></summary><div class=inner><ul><li><a href=#change-logs aria-label="change logs">change logs</a></li><li><a href=#%e6%a6%82%e7%95%a5 aria-label=概略>概略</a></li><li><a href=#introduciton aria-label=Introduciton>Introduciton</a><ul><li><a href=#ml-test-score-%e3%81%ae%e8%a8%88%e7%ae%97%e6%96%b9%e6%b3%95 aria-label="ML Test Score の計算方法">ML Test Score の計算方法</a><ul><li><a href=#%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6 aria-label=前提条件>前提条件</a></li></ul></li><li><a href=#%e7%89%b9%e5%be%b4%e9%87%8f%e3%81%a8%e3%83%87%e3%83%bc%e3%82%bf%e3%82%bb%e3%83%83%e3%83%88 aria-label=特徴量とデータセット>特徴量とデータセット</a></li><li><a href=#%e3%83%a2%e3%83%87%e3%83%ab%e9%96%8b%e7%99%ba aria-label=モデル開発>モデル開発</a></li><li><a href=#%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92%e3%82%a4%e3%83%b3%e3%83%95%e3%83%a9%e3%82%b9%e3%83%88%e3%83%a9%e3%82%af%e3%83%81%e3%83%a3 aria-label=機械学習インフラストラクチャ>機械学習インフラストラクチャ</a></li><li><a href=#%e6%a9%9f%e6%a2%b0%e5%ad%a6%e7%bf%92%e3%81%ae%e3%81%9f%e3%82%81%e3%81%ae%e3%83%a2%e3%83%8b%e3%82%bf%e3%83%aa%e3%83%b3%e3%82%b0%e6%8c%87%e6%a8%99 aria-label=機械学習のためのモニタリング指標>機械学習のためのモニタリング指標</a></li></ul></li></ul></div></details></div><div class=post-content><p>NIPS206 にて開催された <a href=https://sites.google.com/site/wildml2016nips/>Reliable Machine Learning in the Wild - NIPS 2016 Workshop (2016)</a> という、<code>現実世界でどうやって信頼性の高い機械学習に取り組んでいくか</code>についてのワークショップがある。</p><p>ここで Google から発表された <code>What’s your ML test score? A rubric for ML production systems</code> がとても面白く、身になるものが多かったのでメモがてら抄訳を残しておく。</p><ul><li><a href=https://research.google/pubs/pub45742/>PDF</a></li><li><a href="https://0586f9b3-a-62cb3a1a-s-sites.googlegroups.com/site/wildml2016nips/SculleySlides1.pdf?attachauth=ANoY7crr9fea9TxDl1EIyOScNG1yJSo3gBkHKOq5exLlPtetuZ_EiAKL3rJq7h17Nwcx82i0CSwmLWc97IQiQdTBODUaMhMm7CBrbpU7uQXx55Km8JFTLlOMIgFflPev0_chmj41VydTan6OjwAOfeQ_U5tRz7m-HHi0rKvumbALo74j5XV0NbPaXcQDbwInz3CdFaDamzvwOH7nn0V-DADxKf6Kqkv-SA%3D%3D&attredirects=0">Slide</a></li><li>発表動画もワークショップページにて公開されています。</li></ul><h2 id=change-logs>change logs<a hidden class=anchor aria-hidden=true href=#change-logs>#</a></h2><ul><li>2021-04-25<ul><li>この原著論文の完全版になっている論文の抄訳を新たに公開しています。</li><li><a href=https://shunyaueta.com/posts/2020-04-25/>[抄訳]: The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction</a></li></ul></li></ul><hr><h2 id=概略>概略<a hidden class=anchor aria-hidden=true href=#概略>#</a></h2><ul><li>現実世界のプロダクションシステムで機械学習を使う際に、機械学習の研究実験と異なる、小さなもしくは小さくない問題がある</li><li>テストとモニタリングはプロダクションレディの機械学習システムにとって必要不可欠</li><li>しかし、どれくらいのテストとモニタリングをすれば十分と言えるのだろうか?</li><li>この論文では、それらの問題を解決する <code>ML Test Score</code> という基準を提案する</li></ul><h2 id=introduciton>Introduciton<a hidden class=anchor aria-hidden=true href=#introduciton>#</a></h2><ul><li><p>Google 内で積み重ねたベストプラクティスをもとに、実行可能なテスト、そしてその機械学習システムがどのていどプロダクションレディなのかを示すスコアシステムを提案</p></li><li><p>このスコアは、機械学習を始めたばかるのチームからエキスパートがあつまるチームまで幅広く適用可能</p></li><li><p>注意: 一般的な Sofware Engineering のベストプラクティスは含んでいない</p></li><li><p>そのかわり、学習とサービングのための Unit Test Coverage の計算方法など機械学習に必要不可欠な点を抑えている</p></li></ul><h3 id=ml-test-score-の計算方法>ML Test Score の計算方法<a hidden class=anchor aria-hidden=true href=#ml-test-score-の計算方法>#</a></h3><ul><li>各テストの加点基準<ul><li>1pt: 手動で実行し、その結果を文章として共有済</li><li>2pt: CI に組み込まれ、自動的に反復実行済</li></ul></li><li>最終的な ML Score は以下の基準となる<ul><li><code>0pt</code> : プロダクション向けというよりも研究プロジェクト</li><li><code>1-2pt</code> : テストが少しはされているが、プロダクションではもっと深刻な罠がある可能性あり</li><li><code>3-4pt</code> : 最初のプロダクションレディへの第一歩。しかし、さらなる投資が必要</li><li><code>5-6pt</code> : 適切なテストがされているが、もっと自動化してみよう</li><li><code>7-10pt</code> : 自動化されたテストとモニタリングが整備されている。重要なシステムでも適切なレベルに達している</li><li><code>12+pt</code> : 卓越した自動化されたテストとモニタリング</li></ul></li></ul><h4 id=前提条件>前提条件<a hidden class=anchor aria-hidden=true href=#前提条件>#</a></h4><ul><li>システムアーキテクチャの前提として、生データから特徴量を抽出し、学習システムに流し込まれる。そして推論のためにサービングされ、その機能は顧客に影響を与える。また、ソースリポジトリや CI を通したテスト、実験のバージョン管理なども可能</li></ul><h3 id=特徴量とデータセット>特徴量とデータセット<a hidden class=anchor aria-hidden=true href=#特徴量とデータセット>#</a></h3><ul><li>各特徴量の分布が期待した値になっているか?<ul><li>一例として、特徴 A が 1 から５の値を持つ、または特徴 B の最も普遍期な値として「Harry」と「Potter」が全体の 10%を占める特徴に対して、上記の分布を検証するようなテストを書き、このテストが失敗すれば外部環境が変化しモデルの変更が余儀なくされていることが把握できる</li></ul></li><li>各特徴と目的変数の関係性そして、ペアの相関が独立してあらわれるか?<ul><li>個の特徴がモデルに使用される際に、</li></ul></li><li>各特徴量のコストは検討されているか?<ul><li>特徴量のコストとは、各特徴を追加した際の推論速度やメモリ使用率、データ依存  やその特徴に依存することによるシステムの不安定性などの検証</li></ul></li><li>手動作業により適切でない特徴量は使用されていないか?</li><li>データパイプラインの中で、プライバシーコントロールが考慮されているか?<ul><li>Access Controll の権限は機械学習システムにも適切に付与されているか検証を行う</li></ul></li><li>プロダクションモデルへ新しい特徴量を開発・追加するのに必要な日数はいくらか?<ul><li>ちょっとしたアイデアをプロダクションで素早く検証できるチームは強い。速さはシステムの改善と外的変化の対応するために重要</li></ul></li><li>学習とサービングで使用される特徴量生成に関わるコードすべてに対するテスト<ul><li>軽視されがちだが、非常に重要</li></ul></li></ul><h3 id=モデル開発>モデル開発<a hidden class=anchor aria-hidden=true href=#モデル開発>#</a></h3><ul><li>全てのモデルはコードレビューされリポジトリに格納されているか?<ul><li>コードレビューは素晴らしい仕組みで、つまらないミスやインシデントに関わるような潜在的なものまで顕在化される</li></ul></li><li>オフラインの疑似指標とオンライン指標の関係性<ul><li>1%の精度がお客さまの満足度にどうつながるのだろうか? (例: CTR) この検証は意図的に劣化させたモデルなどで小規模の AB テストを通して検証可能</li></ul></li><li>チューニング可能な各ハイパーパラメータのインパクト<ul><li>グリッドサーチやベイズ最適化は、予測性能を向上させるだけではなく潜在的な信頼性の問題を明らかにできる。例えば、データ並列によるモデルの精度の変化は大きなインパクトである</li></ul></li><li>モデルのフレッシュネス<ul><li>各モデルが、<code>昨日</code> VS <code>先週</code> VS <code>過去一年</code> で学習されたとしてオンラインメトリクスへの影響がどう異なるか? 全てのモデルは外部要求により更新を余儀なくされる。この評価は注意深く行い、決定していくこと</li></ul></li><li>単純なモデルをベースラインとした検証<ul><li>線形モデルで少ない特徴量のモデルでベースラインを作成しよう。これは、大規模なパイプライン構築やコストのトレードオフの検証にとても効果的である</li></ul></li><li>重要なデータを分割した際のモデル品質の検証<ul><li>TBD: ちょっと理解しきれない</li></ul></li><li>暗黙的バイアスへの検証<ul><li>例えば学習データの規模が小規模だと暗黙的なバイアスが掛かってしまう。(例：靴の認識で、男物の靴しか学習データが収集できず、女性の靴のデータがほぼ存在しないなど)</li></ul></li></ul><h3 id=機械学習インフラストラクチャ>機械学習インフラストラクチャ<a hidden class=anchor aria-hidden=true href=#機械学習インフラストラクチャ>#</a></h3><ul><li>モデルの学習の再現性検証<ul><li>完全に同一データから、２つのモデル作成する。両者のスコア、サンプルに対する予測結果など大きな違いがないか検証を行う</li></ul></li><li>モデルの仕様に関する検証<ul><li>有用な Assertion として、ロスの低下や学習ジョブがクラッシュしても復元可能など</li></ul></li><li>完全な機械学習パイプラインテストのための結合テスト<ul><li>良い結合テストとは、もとのデータソースから特徴生成 → 学習 またはサービングまでをカバーする。結合テストは CI を通じて実行し、潜在的な問題をリリース前に発見するために新規リリースの前に検証される</li></ul></li><li>サービング前のモデル品質テスト<ul><li>サンプルデータを収集して、既知の正しい出力がされるように検証を行い、集計する。 前バージョンの機械学習モデルの予測結果を用いたバックテストも良い取り組みの一つ</li></ul></li><li>一つのサンプル、もしくはバッチ学習をモデルに送り、学習から予測までの内部状態の変化の監視<ul><li>少量のデータを流し、モデルの状態がどう変化するか監視するのは有効なアプローチである</li></ul></li><li>本番環境前のカナリアリリースによるテスト<ul><li>モデリングのコードはサービングコードと違って高頻度に変化する。それにより以前のサービングコードが新しいモデルでは動かない危険性なども発生する。この検証は、モデルがプロダクション環境下で正常に読み込まれるか、正常に推論が稼働するかを確認する。新しいモデルは常に、小規模のトラフィックで検証されるべきである</li></ul></li><li>新しい機械学習モデルから、安全かつ素早く前の機械学習モデルに戻せるか?<ul><li>モデルのローロバック手続きは、モデルの品質がリリースして良くなかった場合にとても便利である。以前の高性能なモデルに安全かつ素早く戻せる仕組みは非常に重要</li></ul></li></ul><h3 id=機械学習のためのモニタリング指標>機械学習のためのモニタリング指標<a hidden class=anchor aria-hidden=true href=#機械学習のためのモニタリング指標>#</a></h3><ul><li>学習とサービングの両者にて、イベント発生時の不安定性の検証<ul><li>モデルの学習時間の不安定性<ul><li>モデルが頻繁に再学習されるような状況だと、特に問題である</li></ul></li><li>サービング時間の不安定性<ul><li>client 側の通信が停止したりすると、サービングされなくなる</li></ul></li></ul></li><li>学習時とサービング時でデータの不変性が保持されているかの検証<ul><li>例: 特徴量 A と B は、常に同一の非零の要素数を持つ、特徴量 C は常に(0,100)の範囲内かなどを検証する</li></ul></li><li>学習したモデルと、サービングの特徴が完全に同一か<ul><li>Training/ Serviing Skew とも呼ばれている (Concept Drift とも呼ばれています)</li><li>学習したデータと本番のデータが時間経過、もしくは何らかの要因で異なってしまうことが原因です</li><li>Training/Serving skew は <a href=https://github.com/tensorflow/tfx/blob/master/docs/guide/tfdv.md>TFX</a> で説明されている</li></ul></li><li>モデルは枯れているか?<ul><li>使い古されたモデルの場合、パイプラインが停止しても何が原因か把握できる。例えば、重要なテーブルを作成する毎日実行されるジョブがストップしたとして、どんなアラートが良いだろうか? *TBD</li></ul></li><li>学習、もしくはサービング時に<code>NaN</code> または、 無限の値が発生への検証</li><li>学習速度、サービング速度、スループットまたは RAM 使用率の検証<ul><li>スケールする際に機械学習システムの計算機コストは悩みの種である。回帰テストなどで検証されるべきである</li></ul></li><li>予測品質に関する回帰テスト<ul><li>外部要因により、品質が下がる場合もあるが多くの場合は現実の問題を洗い出すことができる</li></ul></li></ul><hr><p>翻訳でもし怪しい部分やもっとこうしたほうが良いというところがあれば、コメントか <a href=https://twitter.com/hurutoriya>@hurutoriya</a> までご連絡ください</p><p>実際読み込んで見ると、信頼性の高いモデルを届けるための秘訣が山盛りで、流石 Google 内のベストプラクティスをまとめたチェックリストですね
実際に開発している機械学習システムがあれば、この Test Score を当てはめてみてどの程度できているのか計測してみるが良さそう</p><p>機械学習エンジニアとして働く自分として、興味のど真ん中にあるようなワークショップだが、2016,2017 年の二回しか開催されておらず、非常に悲しい
逆に言えば、すごく先進的なワークショップでこのワークショップが開催されていたのは凄いことだ</p><p>自分が業務を通じて得た経験やベストプラクティスがすでに論文として世の中に公開されているのはすごく経験になるし、経験から学ぶのではなく歴史から学べるようにしていきたい！
なので、この Workshop 論文の発展形として、<a href=https://research.google/pubs/pub46555/>The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction</a> が発表されているので読んでみる</p><p>いや、実装寄りの勉強ばかりしていたけど気分転換にこういう知識体系に触れるのすごく楽しい</p><h2>See Also</h2><ul><li><a href=/posts/2018-04-09/>Google, Facebookが提供する機械学習基盤まとめ</a></li><li><a href=/posts/2018-04-24/>[抄訳] Data engineers vs. data scientists</a></li><li><a href=/posts/2018-01-14/>Analyzing Free-standing Conversational Groups: A Multimodal Approach (ACMMM15) を読んだ</a></li><li><a href=/posts/2018-01-12/>Call center stress recognition with person-specific models を読んだ</a></li><li><a href=/posts/2018-01-11/>FUSE: Full Spectral Clustering(KDD2016) を読んだ</a></li></ul><h2>Support</h2>記事をお読みくださりありがとうございます。このウェブサイトの運営を支援していただける方を募集しています。
もしよろしければ、下のボタンからサポート(投げ銭)していただけると、ブログ執筆、情報発信のモチベーションに繋がります✨
<a href=https://www.buymeacoffee.com/hurutoriya><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=☕&slug=hurutoriya&button_colour=FFDD00&font_colour=000000&font_family=Inter&outline_colour=000000&coffee_colour=ffffff"></a></div><footer class=post-footer><ul class=post-tags><li><a href=https://shunyaueta.com/tags/paper/>paper</a></li><li><a href=https://shunyaueta.com/tags/machinelearning/>machinelearning</a></li><li><a href=https://shunyaueta.com/tags/mlops/>mlops</a></li><li><a href=https://shunyaueta.com/tags/translation/>translation</a></li></ul><nav class=paginav><a class=prev href=https://shunyaueta.com/posts/2020-04-25/><span class=title>« 前のページ</span><br><span>機械学習システムの信頼性を数値化し、技術的負債を解消する論文「 The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction」</span></a>
<a class=next href=https://shunyaueta.com/posts/2020-04-18/><span class=title>次のページ »</span><br><span>CourseraでHow Google does Machine Learning の講義を修了した</span></a></nav></footer><script src=https://giscus.app/client.js data-repo=hurutoriya/hurutoriya.github.io data-repo-id="MDEwOlJlcG9zaXRvcnk2MDgyNTY1Nw==" data-category=Comments data-category-id=DIC_kwDOA6AgOc4CAQTX data-mapping=pathname data-reactions-enabled=1 data-emit-metadata=0 data-theme=dark data-lang=ja crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://shunyaueta.com/>hurutoriya</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z" /></svg></a><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script><script>document.querySelectorAll('pre > code').forEach((codeblock)=>{const container=codeblock.parentNode.parentNode;const copybutton=document.createElement('button');copybutton.classList.add('copy-code');copybutton.innerHTML='コピー';function copyingDone(){copybutton.innerHTML='コピーされました!';setTimeout(()=>{copybutton.innerHTML='コピー';},2000);}
copybutton.addEventListener('click',(cb)=>{if('clipboard'in navigator){navigator.clipboard.writeText(codeblock.textContent);copyingDone();return;}
const range=document.createRange();range.selectNodeContents(codeblock);const selection=window.getSelection();selection.removeAllRanges();selection.addRange(range);try{document.execCommand('copy');copyingDone();}catch(e){};selection.removeRange(range);});if(container.classList.contains("highlight")){container.appendChild(copybutton);}else if(container.parentNode.firstChild==container){}else if(codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"){codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);}else{codeblock.parentNode.appendChild(copybutton);}});</script></body></html>