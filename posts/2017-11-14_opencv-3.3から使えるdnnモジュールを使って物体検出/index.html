<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>OpenCV 3.3から使えるDNNモジュールを使って物体検出 - Shunya UETA</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="OpenCV 3.3から使えるDNNモジュールを使って物体検出" />
<meta property="og:description" content="OpenCVとMobileNetを使って物体検出を行った Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook Introduction 物体検出をDeep LeaningとOpenCVを用いて行う OpenCV" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/" />

<meta property="og:image" content="https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/images/1.png" />
<meta property="article:published_time" content="2017-11-14T11:36:43+00:00" />
<meta property="article:modified_time" content="2019-06-16T18:16:04+09:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/images/1.png"/>

<meta name="twitter:title" content="OpenCV 3.3から使えるDNNモジュールを使って物体検出"/>
<meta name="twitter:description" content="OpenCVとMobileNetを使って物体検出を行った Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook Introduction 物体検出をDeep LeaningとOpenCVを用いて行う OpenCV"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:500,100,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" /><script src="/js/feather.min.js"></script><script src="/js/main.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title">Shunya UETA</h1>
	<div class="site-description"><h2>Software Engineer As Data Scientist</h2><nav class="nav social">
			<ul class="flat"><a href="https://www.linkedin.com/in/hurutoriya/" title="Linkedin"><i data-feather="linkedin"></i></a><a href="https://github.com/hurutoriya" title="Github"><i data-feather="github"></i></a><a href="https://twitter.com/hurutoriya" title="Twitter"><i data-feather="twitter"></i></a><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">OpenCV 3.3から使えるDNNモジュールを使って物体検出</h1>
			<div class="meta">Posted at &mdash; Nov 14, 2017</div>
		</div>

		<div class="markdown">
			

<p>OpenCVとMobileNetを使って物体検出を行った</p>

<p><img src="/posts/2017-11-14_opencv-3.3から使えるdnnモジュールを使って物体検出/images/1.png" alt="image" /></p>

<p>Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook</p>

<h3 id="introduction">Introduction</h3>

<p>物体検出をDeep LeaningとOpenCVを用いて行う</p>

<p>OpenCV 3.3から<code>dnn</code>モジュールが正式にリリースされた
&gt; _The main news is that we promoted DNN module from opencv<em>contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (</em><a href="http://halide-lang.org"><em>http://halide-lang.org</em></a>_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV.<br />
&gt; _<a href="https://opencv.org/opencv-3-3.html"><em>https://opencv.org/opencv-3-3.html</em></a></p>

<p>今回はそのdnnモジュールを使って物体検出を行う</p>

<ul>
<li><a href="https://github.com/opencv/opencv/tree/master/modules/dnn">OpenCV dnn modules</a></li>
<li><a href="https://github.com/opencv/opencv/tree/master/samples/dnn">Official Sample</a></li>
</ul>

<p>この記事は主に<a href="https://www.pyimagesearch.com/2017/09/11/object-detection-with-deep-learning-and-opencv/">pyimagesearchの記事</a>を参考に行いました。詳細な解説がありがたいですDeep Leaningを基にした物体検出で有名な手法は以下の3つである</p>

<ul>
<li>Faster R-CNN : 2015</li>
<li>YOLO : 2015</li>
<li>SSDs : 2015</li>
</ul>

<p>物体検出を行う際のDNNのアーキテクチャでは主にVGGかResNetが用いられる。しかし欠点としてこれらのアーキテクチャは非常に大きく200–500MBのサイズになってしまう</p>

<p>物体検出において速度、精度、メモリの３つのバランスを考慮する場合、どのアーキテクチャを選ぶべきかをGoogleが論文としてまとめている</p>

<p><a href="https://arxiv.org/abs/1611.10012">[1611.10012] Speed/accuracy trade-offs for modern convolutional object detectors</a></p>

<p>一行でまとめると、基本的に速度と精度はトレードオフであり、最速はSSDs MobileNet, 最高精度はFaster R-CNN w/Inception Resnet at stride 8</p>

<p>今回は省メモリかつ速度が早いSSDs MobileNetを用いて物体検出を行った</p>

<p>Demo on JupyterNotebook</p>

<h3 id="code">Code</h3>

<p><a href="https://github.com/hurutoriya/yolov2_api">hurutoriya/yolov2_api</a></p>

<h3 id="study">Study</h3>

<ul>
<li>Printデバッグをやめて、logging moduleに切り替えた。出力が綺麗になっていい感じ</li>
<li>OpenCVだけでDNNを使えるのは結構便利(学習済モデルとかは必須)</li>
</ul>

<h3 id="future-work">Future Work</h3>

<ul>
<li>YOLO v2もC++のサンプルがあるので、Pythonでも動くようにしたい</li>
<li>Web Appに組み込めるくらい速そうなので、やってみましょう</li>
</ul>

		</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'hurutoriya';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
		Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div><a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="gohugo.io">Hugo</a></div>
	</nav>
</div>

</body>
</html>
