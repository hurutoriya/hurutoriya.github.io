<!doctype html><html lang=ja prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=keywords content="Python,
Opencv,
Deep Learning,
日本語,
Computer Vision,"><meta property="og:type" content="article"><meta property="og:description" content><meta property="og:title" content="OpenCV 3.3から使えるDNNモジュールを使って物体検出"><meta property="og:site_name" content="Shunya UETA"><meta property="og:image" content><meta property="og:image:type" content="image/jpeg"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/"><meta property="og:locale" content="ja"><meta property="article:published_time" content="2017-11-14"><meta property="article:modified_time" content="2017-11-14"><meta property="article:tag" content="Python"><meta property="article:tag" content="Opencv"><meta property="article:tag" content="Deep Learning"><meta property="article:tag" content="日本語"><meta property="article:tag" content="Computer Vision"><meta name=twitter:card content="summary"><meta name=twitter:site content="@hurutoriya"><meta name=twitter:creator content="@hurutoriya"><meta name=twitter:title content="OpenCV 3.3から使えるDNNモジュールを使って物体検出 | Shunya UETA"><meta name=twitter:description content="OpenCVとMobileNetを使って物体検出を行った
Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook
Introduction 物体検出をDeep LeaningとOpenCVを用いて行う
OpenCV 3.3からdnnモジュールが正式にリリースされた
 The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (http://halide-lang.org_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV.|"><meta name=twitter:image:src content><meta name=twitter:domain content="https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/"><title>OpenCV 3.3から使えるDNNモジュールを使って物体検出</title><link rel=canonical href=https://shunyaueta.com/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/><link rel=stylesheet href=https://unpkg.com/tachyons@4.11.1/css/tachyons.min.css><link rel=stylesheet href=https://shunyaueta.com/css/style.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlightjs@9.12.0/styles/github-gist.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-39994406-11','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/apple-touch-icon.png></head><body lang=ja class="sans-serif w-90 w-60-ns center center-ns mv2 mv5-ns" itemscope itemtype=http://schema.org/Article><span class=b>/</span>
<a href=https://shunyaueta.com/ class="b bb bw1 pb1 no-underline black">Shunya UETA</a><section id=main class=mt5><h1 itemprop=name id=title>OpenCV 3.3から使えるDNNモジュールを使って物体検出</h1><article itemprop=articleBody id=content class="w-90 lh-copy"><p>OpenCVとMobileNetを使って物体検出を行った</p><p><img src=/posts/2017-11-14_opencv-3.3%E3%81%8B%E3%82%89%E4%BD%BF%E3%81%88%E3%82%8Bdnn%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E7%89%A9%E4%BD%93%E6%A4%9C%E5%87%BA/images/1.png alt=image></p><p>Object Detection with OpenCV dnn modules and MobileNetSSD on Jupyter Notebook</p><h3 id=introduction>Introduction</h3><p>物体検出をDeep LeaningとOpenCVを用いて行う</p><p>OpenCV 3.3から<code>dnn</code>モジュールが正式にリリースされた</p><blockquote><p><em>The main news is that we promoted DNN module from opencv_contrib to the main repository, improved and accelerated it a lot. An external BLAS implementation is not needed anymore. For GPU there is experimental DNN acceleration using Halide (</em><a href=http://halide-lang.org><em>http://halide-lang.org</em></a>_). The detailed information about the module can be found in our wiki: Deep Learning in OpenCV.<br>_<a href=https://opencv.org/opencv-3-3.html><em>https://opencv.org/opencv-3-3.html</em></a></p></blockquote><p>今回はそのdnnモジュールを使って物体検出を行う</p><ul><li><a href=https://github.com/opencv/opencv/tree/master/modules/dnn>OpenCV dnn modules</a></li><li><a href=https://github.com/opencv/opencv/tree/master/samples/dnn>Official Sample</a></li></ul><p>この記事は主に<a href=https://www.pyimagesearch.com/2017/09/11/object-detection-with-deep-learning-and-opencv/>pyimagesearchの記事</a>を参考に行いました。詳細な解説がありがたいですDeep Leaningを基にした物体検出で有名な手法は以下の3つである</p><ul><li>Faster R-CNN : 2015</li><li>YOLO : 2015</li><li>SSDs : 2015</li></ul><p>物体検出を行う際のDNNのアーキテクチャでは主にVGGかResNetが用いられる。しかし欠点としてこれらのアーキテクチャは非常に大きく200–500MBのサイズになってしまう</p><p>物体検出において速度、精度、メモリの３つのバランスを考慮する場合、どのアーキテクチャを選ぶべきかをGoogleが論文としてまとめている</p><p><a href=https://arxiv.org/abs/1611.10012>[1611.10012] Speed/accuracy trade-offs for modern convolutional object detectors</a></p><p>一行でまとめると、基本的に速度と精度はトレードオフであり、最速はSSDs MobileNet, 最高精度はFaster R-CNN w/Inception Resnet at stride 8</p><p>今回は省メモリかつ速度が早いSSDs MobileNetを用いて物体検出を行った</p><p>Demo on JupyterNotebook</p><h3 id=code>Code</h3><p><a href=https://github.com/hurutoriya/yolov2_api>hurutoriya/yolov2_api</a></p><h3 id=study>Study</h3><ul><li>Printデバッグをやめて、logging moduleに切り替えた。出力が綺麗になっていい感じ</li><li>OpenCVだけでDNNを使えるのは結構便利(学習済モデルとかは必須)</li></ul><h3 id=future-work>Future Work</h3><ul><li>YOLO v2もC++のサンプルがあるので、Pythonでも動くようにしたい</li><li>Web Appに組み込めるくらい速そうなので、やってみましょう</li></ul></article></section><footer><div><p class="f6 gray mt6 lh-copy">© 2016-20 <a href=https://twitter.com/hurutoriya>@hurutoriya</a>.</p></div></footer><script src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>